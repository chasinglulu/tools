From 4a68be920a873eec6521d431f4975ef849e4535f Mon Sep 17 00:00:00 2001
From: "xinlu.wang" <xinlu.wang@horizon.ai>
Date: Wed, 6 Jul 2022 22:29:34 +0800
Subject: [PATCH] ftrace: feat [J5P-1288] Switch all event tracepoints by
 default with ftrace

Signed-off-by: xinlu.wang <xinlu.wang@horizon.ai>
---
 drivers/base/regmap/trace.h                   |   3 +
 drivers/char/random.c                         |   5 +-
 drivers/nvme/host/core.c                      |   4 +
 drivers/nvme/host/trace.h                     |   3 +
 fs/buffer.c                                   |   2 +-
 fs/exec.c                                     |   5 +-
 fs/fs-writeback.c                             |   4 +
 fs/io_uring.c                                 |   5 +-
 fs/iomap/trace.h                              |   3 +
 fs/locks.c                                    |   5 +-
 fs/nfs/nfs4trace.h                            |   3 +
 fs/nfs/nfstrace.h                             |   3 +
 include/linux/trace_events.h                  |   3 +
 include/linux/tracepoint.h                    |  12 +
 include/ras/ras_event.h                       |   3 +
 include/trace/events/9p.h                     |   3 +
 include/trace/events/afs.h                    |   3 +
 include/trace/events/alarmtimer.h             |   3 +
 include/trace/events/asoc.h                   |   3 +
 include/trace/events/avc.h                    |   3 +
 include/trace/events/bcache.h                 |   3 +
 include/trace/events/block.h                  |   3 +
 include/trace/events/bpf_test_run.h           |   3 +
 include/trace/events/bridge.h                 |   3 +
 include/trace/events/btrfs.h                  |   3 +
 include/trace/events/cachefiles.h             |   3 +
 include/trace/events/cgroup.h                 |   3 +
 include/trace/events/clk.h                    |   3 +
 include/trace/events/cma.h                    |   3 +
 include/trace/events/compaction.h             |   3 +
 include/trace/events/context_tracking.h       |   3 +
 include/trace/events/cpuhp.h                  |   3 +
 include/trace/events/devfreq.h                |   3 +
 include/trace/events/devlink.h                |   3 +
 include/trace/events/dma_fence.h              |   3 +
 include/trace/events/erofs.h                  |   3 +
 include/trace/events/ext4.h                   |   3 +
 include/trace/events/f2fs.h                   |   3 +
 include/trace/events/fib.h                    |   3 +
 include/trace/events/fib6.h                   |   3 +
 include/trace/events/filelock.h               |   3 +
 include/trace/events/filemap.h                |   3 +
 include/trace/events/fs_dax.h                 |   3 +
 include/trace/events/fscache.h                |   3 +
 include/trace/events/fsi.h                    |   3 +
 include/trace/events/fsi_master_aspeed.h      |   3 +
 include/trace/events/fsi_master_ast_cf.h      |   3 +
 include/trace/events/fsi_master_gpio.h        |   3 +
 include/trace/events/gpio.h                   |   3 +
 include/trace/events/gpu_mem.h                |   3 +
 include/trace/events/host1x.h                 |   3 +
 include/trace/events/huge_memory.h            |   3 +
 include/trace/events/hwmon.h                  |   3 +
 include/trace/events/i2c.h                    |   3 +
 include/trace/events/ib_mad.h                 |   3 +
 include/trace/events/ib_umad.h                |   3 +
 include/trace/events/initcall.h               |   3 +
 include/trace/events/intel-sst.h              |   3 +
 include/trace/events/intel_iommu.h            |   3 +
 include/trace/events/intel_ish.h              |   3 +
 include/trace/events/io_uring.h               |   3 +
 include/trace/events/iocost.h                 |   3 +
 include/trace/events/iommu.h                  |   3 +
 include/trace/events/ipi.h                    |   3 +
 include/trace/events/irq.h                    |   3 +
 include/trace/events/irq_matrix.h             |   3 +
 include/trace/events/iscsi.h                  |   3 +
 include/trace/events/jbd2.h                   |   3 +
 include/trace/events/kmem.h                   |   3 +
 include/trace/events/kvm.h                    |   3 +
 include/trace/events/kyber.h                  |   3 +
 include/trace/events/libata.h                 |   3 +
 include/trace/events/lock.h                   |   3 +
 include/trace/events/mce.h                    |   3 +
 include/trace/events/mdio.h                   |   3 +
 include/trace/events/migrate.h                |   3 +
 include/trace/events/mlxsw.h                  |   3 +
 include/trace/events/mmap.h                   |   3 +
 include/trace/events/mmc.h                    |   3 +
 include/trace/events/module.h                 |   3 +
 include/trace/events/napi.h                   |   3 +
 include/trace/events/nbd.h                    |   3 +
 include/trace/events/neigh.h                  |   3 +
 include/trace/events/net.h                    |   3 +
 include/trace/events/nilfs2.h                 |   3 +
 include/trace/events/nmi.h                    |   3 +
 include/trace/events/objagg.h                 |   3 +
 include/trace/events/oom.h                    |   4 +
 include/trace/events/page_isolation.h         |   3 +
 include/trace/events/page_pool.h              |   3 +
 include/trace/events/page_ref.h               |   3 +
 include/trace/events/pagemap.h                |   3 +
 include/trace/events/percpu.h                 |   3 +
 include/trace/events/power.h                  |   3 +
 include/trace/events/power_cpu_migrate.h      |   3 +
 include/trace/events/preemptirq.h             |   3 +
 include/trace/events/printk.h                 |   3 +
 include/trace/events/pwc.h                    |   3 +
 include/trace/events/pwm.h                    |   3 +
 include/trace/events/qdisc.h                  |   3 +
 include/trace/events/qla.h                    |   3 +
 include/trace/events/qrtr.h                   |   3 +
 include/trace/events/random.h                 |   3 +
 include/trace/events/rcu.h                    |   3 +
 include/trace/events/rdma_core.h              |   3 +
 include/trace/events/regulator.h              |   3 +
 include/trace/events/rpcgss.h                 |   3 +
 include/trace/events/rpcrdma.h                |   3 +
 include/trace/events/rpm.h                    |   3 +
 include/trace/events/rseq.h                   |   3 +
 include/trace/events/rtc.h                    |   3 +
 include/trace/events/rxrpc.h                  |   3 +
 include/trace/events/sched.h                  |   3 +
 include/trace/events/scmi.h                   |   3 +
 include/trace/events/scsi.h                   |   3 +
 include/trace/events/sctp.h                   |   3 +
 include/trace/events/signal.h                 |   3 +
 include/trace/events/siox.h                   |   3 +
 include/trace/events/skb.h                    |   3 +
 include/trace/events/smbus.h                  |   3 +
 include/trace/events/sock.h                   |   3 +
 include/trace/events/spi.h                    |   3 +
 include/trace/events/spmi.h                   |   3 +
 include/trace/events/sunrpc.h                 |   3 +
 include/trace/events/sunvnet.h                |   3 +
 include/trace/events/swiotlb.h                |   3 +
 include/trace/events/syscalls.h               |   3 +
 include/trace/events/target.h                 |   3 +
 include/trace/events/task.h                   |   4 +
 include/trace/events/tcp.h                    |   3 +
 include/trace/events/tegra_apb_dma.h          |   3 +
 include/trace/events/thermal.h                |   3 +
 .../trace/events/thermal_power_allocator.h    |   3 +
 include/trace/events/thp.h                    |   3 +
 include/trace/events/timer.h                  |   3 +
 include/trace/events/tlb.h                    |   3 +
 include/trace/events/udp.h                    |   3 +
 include/trace/events/ufs.h                    |   3 +
 include/trace/events/v4l2.h                   |   3 +
 include/trace/events/vb2.h                    |   3 +
 include/trace/events/vmscan.h                 |   3 +
 .../events/vsock_virtio_transport_common.h    |   3 +
 include/trace/events/wbt.h                    |   3 +
 include/trace/events/workqueue.h              |   3 +
 include/trace/events/writeback.h              |   3 +
 include/trace/events/xdp.h                    |   3 +
 include/trace/events/xen.h                    |   3 +
 init/main.c                                   |   5 +-
 kernel/exit.c                                 |   2 +-
 kernel/fork.c                                 |   3 +-
 kernel/kmod.c                                 |   3 +-
 kernel/module.c                               |   5 +-
 kernel/power/process.c                        |   2 +-
 kernel/printk/printk.c                        |   5 +-
 kernel/rseq.c                                 |   5 +-
 kernel/sched/idle.c                           |   3 +-
 kernel/sched/sched.h                          |   3 +-
 kernel/signal.c                               |   5 +-
 kernel/time/hrtimer.c                         |   3 +-
 kernel/time/itimer.c                          |   2 +-
 kernel/time/timer.c                           |   7 +-
 kernel/trace/Kconfig                          |   3 +
 kernel/trace/Kconfig.tracepoint               | 877 ++++++++++++++++++
 kernel/trace/bpf_trace.c                      |   5 +-
 kernel/trace/bpf_trace.h                      |   4 +
 kernel/trace/trace_irqsoff.c                  |   3 +-
 kernel/trace/trace_preemptirq.c               |   3 +-
 mm/migrate.c                                  |   5 +-
 mm/mmap.c                                     |   5 +-
 mm/page-writeback.c                           |   2 +-
 170 files changed, 1364 insertions(+), 57 deletions(-)
 create mode 100644 kernel/trace/Kconfig.tracepoint

diff --git a/drivers/base/regmap/trace.h b/drivers/base/regmap/trace.h
index d4066fa079ab..c9eb7cfec0ad 100644
--- a/drivers/base/regmap/trace.h
+++ b/drivers/base/regmap/trace.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_REGMAP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_REGMAP_H
 
+#ifndef CONFIG_TRACEPOINT_REGMAP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 
diff --git a/drivers/char/random.c b/drivers/char/random.c
index 209220eca36f..1a070cf9f5f0 100644
--- a/drivers/char/random.c
+++ b/drivers/char/random.c
@@ -332,6 +332,8 @@
 #include <linux/workqueue.h>
 #include <linux/irq.h>
 #include <linux/ratelimit.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/random.h>
 #include <linux/syscalls.h>
 #include <linux/completion.h>
 #include <linux/uuid.h>
@@ -344,9 +346,6 @@
 #include <asm/irq_regs.h>
 #include <asm/io.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/random.h>
-
 /* #define ADD_INTERRUPT_BENCH */
 
 /*
diff --git a/drivers/nvme/host/core.c b/drivers/nvme/host/core.c
index ff5a16b17133..d70b18c75b68 100644
--- a/drivers/nvme/host/core.c
+++ b/drivers/nvme/host/core.c
@@ -21,6 +21,10 @@
 #include <linux/nvme_ioctl.h>
 #include <linux/pm_qos.h>
 #include <asm/unaligned.h>
+#ifndef CONFIG_TRACEPOINT_NVME_SWITCH_ON
+#define NOTRACE
+#endif
+#include <linux/tracepoint.h>
 
 #include "nvme.h"
 #include "fabrics.h"
diff --git a/drivers/nvme/host/trace.h b/drivers/nvme/host/trace.h
index 35bac7a25422..2650623e44fa 100644
--- a/drivers/nvme/host/trace.h
+++ b/drivers/nvme/host/trace.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_NVME_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NVME_H
 
+#ifndef CONFIG_TRACEPOINT_NVME_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/nvme.h>
 #include <linux/tracepoint.h>
 #include <linux/trace_seq.h>
diff --git a/fs/buffer.c b/fs/buffer.c
index 23f645657488..55f2977c1f98 100644
--- a/fs/buffer.c
+++ b/fs/buffer.c
@@ -21,6 +21,7 @@
 
 #include <linux/kernel.h>
 #include <linux/sched/signal.h>
+#include <trace/events/block.h>
 #include <linux/syscalls.h>
 #include <linux/fs.h>
 #include <linux/iomap.h>
@@ -46,7 +47,6 @@
 #include <linux/bit_spinlock.h>
 #include <linux/pagevec.h>
 #include <linux/sched/mm.h>
-#include <trace/events/block.h>
 #include <linux/fscrypt.h>
 
 #include "internal.h"
diff --git a/fs/exec.c b/fs/exec.c
index c7a4ef8df305..002947a003bb 100644
--- a/fs/exec.c
+++ b/fs/exec.c
@@ -52,6 +52,8 @@
 #include <linux/namei.h>
 #include <linux/mount.h>
 #include <linux/security.h>
+#include <trace/events/task.h>
+#include <trace/events/sched.h>
 #include <linux/syscalls.h>
 #include <linux/tsacct_kern.h>
 #include <linux/cn_proc.h>
@@ -69,11 +71,8 @@
 #include <asm/mmu_context.h>
 #include <asm/tlb.h>
 
-#include <trace/events/task.h>
 #include "internal.h"
 
-#include <trace/events/sched.h>
-
 static int bprm_creds_from_file(struct linux_binprm *bprm);
 
 int suid_dumpable = 0;
diff --git a/fs/fs-writeback.c b/fs/fs-writeback.c
index a0869194ab73..11f7d179f94a 100644
--- a/fs/fs-writeback.c
+++ b/fs/fs-writeback.c
@@ -14,6 +14,10 @@
  *		Additions for address_space-based writeback
  */
 
+#ifndef CONFIG_TRACEPOINT_WRITEBACK_SWITCH_ON
+#define NOTRACE
+#endif
+
 #include <linux/kernel.h>
 #include <linux/export.h>
 #include <linux/spinlock.h>
diff --git a/fs/io_uring.c b/fs/io_uring.c
index f9b9b4c82618..7d53a115706c 100644
--- a/fs/io_uring.c
+++ b/fs/io_uring.c
@@ -42,6 +42,8 @@
 #include <linux/kernel.h>
 #include <linux/init.h>
 #include <linux/errno.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/io_uring.h>
 #include <linux/syscalls.h>
 #include <linux/compat.h>
 #include <net/compat.h>
@@ -83,9 +85,6 @@
 #include <linux/blk-cgroup.h>
 #include <linux/audit.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/io_uring.h>
-
 #include <uapi/linux/io_uring.h>
 
 #include "internal.h"
diff --git a/fs/iomap/trace.h b/fs/iomap/trace.h
index fdc7ae388476..e63865bc759a 100644
--- a/fs/iomap/trace.h
+++ b/fs/iomap/trace.h
@@ -11,6 +11,9 @@
 #if !defined(_IOMAP_TRACE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _IOMAP_TRACE_H
 
+#ifndef CONFIG_TRACEPOINT_IOMAP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct inode;
diff --git a/fs/locks.c b/fs/locks.c
index 32c948fe2944..edb20e08ae8c 100644
--- a/fs/locks.c
+++ b/fs/locks.c
@@ -162,6 +162,8 @@
 #include <linux/init.h>
 #include <linux/security.h>
 #include <linux/slab.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/filelock.h>
 #include <linux/syscalls.h>
 #include <linux/time.h>
 #include <linux/rcupdate.h>
@@ -169,9 +171,6 @@
 #include <linux/hashtable.h>
 #include <linux/percpu.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/filelock.h>
-
 #include <linux/uaccess.h>
 
 #define IS_POSIX(fl)	(fl->fl_flags & FL_POSIX)
diff --git a/fs/nfs/nfs4trace.h b/fs/nfs/nfs4trace.h
index 484c1da96dea..b12a008f1e9c 100644
--- a/fs/nfs/nfs4trace.h
+++ b/fs/nfs/nfs4trace.h
@@ -8,6 +8,9 @@
 #if !defined(_TRACE_NFS4_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NFS4_H
 
+#ifndef CONFIG_TRACEPOINT_NFS4_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_DEFINE_ENUM(EPERM);
diff --git a/fs/nfs/nfstrace.h b/fs/nfs/nfstrace.h
index 5a59dcdce0b2..defc7231f538 100644
--- a/fs/nfs/nfstrace.h
+++ b/fs/nfs/nfstrace.h
@@ -8,6 +8,9 @@
 #if !defined(_TRACE_NFS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NFS_H
 
+#ifndef CONFIG_TRACEPOINT_NFS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/iversion.h>
 
diff --git a/include/linux/trace_events.h b/include/linux/trace_events.h
index 89c3f7162267..117f0621a509 100644
--- a/include/linux/trace_events.h
+++ b/include/linux/trace_events.h
@@ -8,6 +8,9 @@
 #include <linux/percpu.h>
 #include <linux/hardirq.h>
 #include <linux/perf_event.h>
+#ifndef CONFIG_TRACEPOINT_RCU_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct trace_array;
diff --git a/include/linux/tracepoint.h b/include/linux/tracepoint.h
index e4c5df71f0e7..254df418d221 100644
--- a/include/linux/tracepoint.h
+++ b/include/linux/tracepoint.h
@@ -159,6 +159,12 @@ static inline struct tracepoint *tracepoint_ptr_deref(tracepoint_ptr_t *p)
 #define TRACEPOINTS_ENABLED
 #endif
 
+// #ifdef TRACEPOINTS_ENABLED
+// #error "11111111111111111111111"
+// #else
+// #error "22222222222222222222222"
+// #endif
+
 #ifdef TRACEPOINTS_ENABLED
 
 #ifdef CONFIG_HAVE_STATIC_CALL
@@ -354,6 +360,12 @@ static inline struct tracepoint *tracepoint_ptr_deref(tracepoint_ptr_t *p)
 		return -ENOSYS;						\
 	}								\
 	static inline int						\
+	register_trace_prio_##name(void (*probe)(data_proto),		\
+			      void *data, int prio)			\
+	{								\
+		return -ENOSYS;						\
+	}								\
+	static inline int						\
 	unregister_trace_##name(void (*probe)(data_proto),		\
 				void *data)				\
 	{								\
diff --git a/include/ras/ras_event.h b/include/ras/ras_event.h
index 0bdbc0d17d2f..710098fbd1f0 100644
--- a/include/ras/ras_event.h
+++ b/include/ras/ras_event.h
@@ -6,6 +6,9 @@
 #if !defined(_TRACE_HW_EVENT_MC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_HW_EVENT_MC_H
 
+#ifndef CONFIG_TRACEPOINT_RAS_EVENT_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/edac.h>
 #include <linux/ktime.h>
diff --git a/include/trace/events/9p.h b/include/trace/events/9p.h
index 78c5608a1648..ab85ec2bb5b0 100644
--- a/include/trace/events/9p.h
+++ b/include/trace/events/9p.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_9P_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_9P_H
 
+#ifndef CONFIG_TRACEPOINT_9P_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #define P9_MSG_T							\
diff --git a/include/trace/events/afs.h b/include/trace/events/afs.h
index 5deb9f490f6f..68e2bc4de2d4 100644
--- a/include/trace/events/afs.h
+++ b/include/trace/events/afs.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_AFS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_AFS_H
 
+#ifndef CONFIG_TRACEPOINT_AFS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 /*
diff --git a/include/trace/events/alarmtimer.h b/include/trace/events/alarmtimer.h
index 13483c7ca70b..7964cd7e209b 100644
--- a/include/trace/events/alarmtimer.h
+++ b/include/trace/events/alarmtimer.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_ALARMTIMER_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_ALARMTIMER_H
 
+#ifndef CONFIG_TRACEPOINT_ALARMTIMER_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/alarmtimer.h>
 #include <linux/rtc.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/asoc.h b/include/trace/events/asoc.h
index 40c300fe704d..7bc49f19e838 100644
--- a/include/trace/events/asoc.h
+++ b/include/trace/events/asoc.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_ASOC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_ASOC_H
 
+#ifndef CONFIG_TRACEPOINT_ASOC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/avc.h b/include/trace/events/avc.h
index b55fda2e0773..2bb5b570edf5 100644
--- a/include/trace/events/avc.h
+++ b/include/trace/events/avc.h
@@ -9,6 +9,9 @@
 #if !defined(_TRACE_SELINUX_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SELINUX_H
 
+#ifndef CONFIG_TRACEPOINT_AVC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(selinux_audited,
diff --git a/include/trace/events/bcache.h b/include/trace/events/bcache.h
index e41c611d6d3b..7b0ed46eb71e 100644
--- a/include/trace/events/bcache.h
+++ b/include/trace/events/bcache.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_BCACHE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_BCACHE_H
 
+#ifndef CONFIG_TRACEPOINT_BCACHE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 DECLARE_EVENT_CLASS(bcache_request,
diff --git a/include/trace/events/block.h b/include/trace/events/block.h
index 34d64ca306b1..d12303f045de 100644
--- a/include/trace/events/block.h
+++ b/include/trace/events/block.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_BLOCK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_BLOCK_H
 
+#ifndef CONFIG_TRACEPOINT_BLOCK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/blktrace_api.h>
 #include <linux/blkdev.h>
 #include <linux/buffer_head.h>
diff --git a/include/trace/events/bpf_test_run.h b/include/trace/events/bpf_test_run.h
index 265447e3f71a..e5a513be7e5f 100644
--- a/include/trace/events/bpf_test_run.h
+++ b/include/trace/events/bpf_test_run.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_BPF_TEST_RUN_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_BPF_TEST_RUN_H
 
+#ifndef CONFIG_TRACEPOINT_BPF_TEST_RUN_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 DECLARE_EVENT_CLASS(bpf_test_finish,
diff --git a/include/trace/events/bridge.h b/include/trace/events/bridge.h
index 6b200059c2c5..b91bbf77f0bb 100644
--- a/include/trace/events/bridge.h
+++ b/include/trace/events/bridge.h
@@ -4,6 +4,9 @@
 #if !defined(_TRACE_BRIDGE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_BRIDGE_H
 
+#ifndef CONFIG_TRACEPOINT_BRIDGE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/netdevice.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/btrfs.h b/include/trace/events/btrfs.h
index ecd24c719de4..df5f6987460e 100644
--- a/include/trace/events/btrfs.h
+++ b/include/trace/events/btrfs.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_BTRFS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_BTRFS_H
 
+#ifndef CONFIG_TRACEPOINT_BTRFS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/writeback.h>
 #include <linux/tracepoint.h>
 #include <trace/events/mmflags.h>
diff --git a/include/trace/events/cachefiles.h b/include/trace/events/cachefiles.h
index 5d9de24cb9c0..c77d4d521880 100644
--- a/include/trace/events/cachefiles.h
+++ b/include/trace/events/cachefiles.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_CACHEFILES_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_CACHEFILES_H
 
+#ifndef CONFIG_TRACEPOINT_CACHEFILES_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 /*
diff --git a/include/trace/events/cgroup.h b/include/trace/events/cgroup.h
index 7f42a3de59e6..26ced4f351de 100644
--- a/include/trace/events/cgroup.h
+++ b/include/trace/events/cgroup.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_CGROUP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_CGROUP_H
 
+#ifndef CONFIG_TRACEPOINT_CGROUP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/cgroup.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/clk.h b/include/trace/events/clk.h
index cb1aea25c199..213e7dbefa36 100644
--- a/include/trace/events/clk.h
+++ b/include/trace/events/clk.h
@@ -8,6 +8,9 @@
 #if !defined(_TRACE_CLK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_CLK_H
 
+#ifndef CONFIG_TRACEPOINT_CLK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct clk_core;
diff --git a/include/trace/events/cma.h b/include/trace/events/cma.h
index 5017a8829270..db4f1a6ca86a 100644
--- a/include/trace/events/cma.h
+++ b/include/trace/events/cma.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_CMA_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_CMA_H
 
+#ifndef CONFIG_TRACEPOINT_CMA_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/compaction.h b/include/trace/events/compaction.h
index 54e5bf081171..5b6bbf7674a8 100644
--- a/include/trace/events/compaction.h
+++ b/include/trace/events/compaction.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_COMPACTION_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_COMPACTION_H
 
+#ifndef CONFIG_TRACEPOINT_COMPACTION_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/list.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/context_tracking.h b/include/trace/events/context_tracking.h
index 0aa6fd68fdf9..53e2dc982690 100644
--- a/include/trace/events/context_tracking.h
+++ b/include/trace/events/context_tracking.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_CONTEXT_TRACKING_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_CONTEXT_TRACKING_H
 
+#ifndef CONFIG_TRACEPOINT_CONTEXT_TRACKING_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 DECLARE_EVENT_CLASS(context_tracking_user,
diff --git a/include/trace/events/cpuhp.h b/include/trace/events/cpuhp.h
index ad16f77310c6..359b8bbc5b68 100644
--- a/include/trace/events/cpuhp.h
+++ b/include/trace/events/cpuhp.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_CPUHP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_CPUHP_H
 
+#ifndef CONFIG_TRACEPOINT_CPUHP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(cpuhp_enter,
diff --git a/include/trace/events/devfreq.h b/include/trace/events/devfreq.h
index cf5b8772175d..ab9edb8ba7fb 100644
--- a/include/trace/events/devfreq.h
+++ b/include/trace/events/devfreq.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_DEVFREQ_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_DEVFREQ_H
 
+#ifndef CONFIG_TRACEPOINT_DEVFREQ_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/devfreq.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/devlink.h b/include/trace/events/devlink.h
index 44d8e2981065..c17090b0c3dc 100644
--- a/include/trace/events/devlink.h
+++ b/include/trace/events/devlink.h
@@ -7,6 +7,9 @@
 #if !defined(_TRACE_DEVLINK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_DEVLINK_H
 
+#ifndef CONFIG_TRACEPOINT_DEVLINK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/device.h>
 #include <net/devlink.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/dma_fence.h b/include/trace/events/dma_fence.h
index 64e92d56c6a8..11be4ca6ff8a 100644
--- a/include/trace/events/dma_fence.h
+++ b/include/trace/events/dma_fence.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_DMA_FENCE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_DMA_FENCE_H
 
+#ifndef CONFIG_TRACEPOINT_DMA_FENCE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct dma_fence;
diff --git a/include/trace/events/erofs.h b/include/trace/events/erofs.h
index bf9806fd1306..d6553f5fcc67 100644
--- a/include/trace/events/erofs.h
+++ b/include/trace/events/erofs.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_EROFS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_EROFS_H
 
+#ifndef CONFIG_TRACEPOINT_EROFS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/fs.h>
 
diff --git a/include/trace/events/ext4.h b/include/trace/events/ext4.h
index 70ae5497b73a..ca417481c277 100644
--- a/include/trace/events/ext4.h
+++ b/include/trace/events/ext4.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_EXT4_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_EXT4_H
 
+#ifndef CONFIG_TRACEPOINT_EXT4_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/writeback.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/f2fs.h b/include/trace/events/f2fs.h
index 56b113e3cd6a..d4145fbe70e4 100644
--- a/include/trace/events/f2fs.h
+++ b/include/trace/events/f2fs.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_F2FS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_F2FS_H
 
+#ifndef CONFIG_TRACEPOINT_F2FS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <uapi/linux/f2fs.h>
 
diff --git a/include/trace/events/fib.h b/include/trace/events/fib.h
index 6f2a4dc35e37..f5956425a03d 100644
--- a/include/trace/events/fib.h
+++ b/include/trace/events/fib.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_FIB_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FIB_H
 
+#ifndef CONFIG_TRACEPOINT_FIB_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/skbuff.h>
 #include <linux/netdevice.h>
 #include <net/ip_fib.h>
diff --git a/include/trace/events/fib6.h b/include/trace/events/fib6.h
index c6abdcc77c12..80eeb3823fac 100644
--- a/include/trace/events/fib6.h
+++ b/include/trace/events/fib6.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_FIB6_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FIB6_H
 
+#ifndef CONFIG_TRACEPOINT_FIB6_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/in6.h>
 #include <net/flow.h>
 #include <net/ip6_fib.h>
diff --git a/include/trace/events/filelock.h b/include/trace/events/filelock.h
index 1646dadd7f37..1b3e3aa68f0a 100644
--- a/include/trace/events/filelock.h
+++ b/include/trace/events/filelock.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_FILELOCK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FILELOCK_H
 
+#ifndef CONFIG_TRACEPOINT_FILELOCK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/fs.h>
 #include <linux/device.h>
diff --git a/include/trace/events/filemap.h b/include/trace/events/filemap.h
index 796053e162d2..f5ed9b411cb1 100644
--- a/include/trace/events/filemap.h
+++ b/include/trace/events/filemap.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_FILEMAP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FILEMAP_H
 
+#ifndef CONFIG_TRACEPOINT_FILEMAP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/tracepoint.h>
 #include <linux/mm.h>
diff --git a/include/trace/events/fs_dax.h b/include/trace/events/fs_dax.h
index 97b09fcf7e52..13036e759839 100644
--- a/include/trace/events/fs_dax.h
+++ b/include/trace/events/fs_dax.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_FS_DAX_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FS_DAX_H
 
+#ifndef CONFIG_TRACEPOINT_FS_DAX_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 DECLARE_EVENT_CLASS(dax_pmd_fault_class,
diff --git a/include/trace/events/fscache.h b/include/trace/events/fscache.h
index d16fe6ed78a2..2ec306411ae5 100644
--- a/include/trace/events/fscache.h
+++ b/include/trace/events/fscache.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_FSCACHE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FSCACHE_H
 
+#ifndef CONFIG_TRACEPOINT_FSCACHE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/fscache.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/fsi.h b/include/trace/events/fsi.h
index 9832cb8e0eb0..d4e21bcccbe7 100644
--- a/include/trace/events/fsi.h
+++ b/include/trace/events/fsi.h
@@ -6,6 +6,9 @@
 #if !defined(_TRACE_FSI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FSI_H
 
+#ifndef CONFIG_TRACEPOINT_FSI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(fsi_master_read,
diff --git a/include/trace/events/fsi_master_aspeed.h b/include/trace/events/fsi_master_aspeed.h
index a355ceacc33f..4091004d0c8c 100644
--- a/include/trace/events/fsi_master_aspeed.h
+++ b/include/trace/events/fsi_master_aspeed.h
@@ -6,6 +6,9 @@
 #if !defined(_TRACE_FSI_MASTER_ASPEED_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FSI_MASTER_ASPEED_H
 
+#ifndef CONFIG_TRACEPOINT_FSI_MASTER_ASPEED_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(fsi_master_aspeed_opb_read,
diff --git a/include/trace/events/fsi_master_ast_cf.h b/include/trace/events/fsi_master_ast_cf.h
index a0fdfa58622a..925647d3dc85 100644
--- a/include/trace/events/fsi_master_ast_cf.h
+++ b/include/trace/events/fsi_master_ast_cf.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_FSI_MASTER_ACF_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FSI_MASTER_ACF_H
 
+#ifndef CONFIG_TRACEPOINT_FSI_MASTER_AST_CF_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(fsi_master_acf_copro_command,
diff --git a/include/trace/events/fsi_master_gpio.h b/include/trace/events/fsi_master_gpio.h
index 70ef66e63e84..233b7bc58070 100644
--- a/include/trace/events/fsi_master_gpio.h
+++ b/include/trace/events/fsi_master_gpio.h
@@ -6,6 +6,9 @@
 #if !defined(_TRACE_FSI_MASTER_GPIO_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_FSI_MASTER_GPIO_H
 
+#ifndef CONFIG_TRACEPOINT_FSI_MASTER_GPIO_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(fsi_master_gpio_in,
diff --git a/include/trace/events/gpio.h b/include/trace/events/gpio.h
index 3aa9fd86d748..2206cce75b89 100644
--- a/include/trace/events/gpio.h
+++ b/include/trace/events/gpio.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_GPIO_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_GPIO_H
 
+#ifndef CONFIG_TRACEPOINT_GPIO_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(gpio_direction,
diff --git a/include/trace/events/gpu_mem.h b/include/trace/events/gpu_mem.h
index 26d871f96e94..d9214033ab24 100644
--- a/include/trace/events/gpu_mem.h
+++ b/include/trace/events/gpu_mem.h
@@ -11,6 +11,9 @@
 #if !defined(_TRACE_GPU_MEM_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_GPU_MEM_H
 
+#ifndef CONFIG_TRACEPOINT_GPU_MEM_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 /*
diff --git a/include/trace/events/host1x.h b/include/trace/events/host1x.h
index 1ba84b738e46..fc21a8bf8f5b 100644
--- a/include/trace/events/host1x.h
+++ b/include/trace/events/host1x.h
@@ -13,6 +13,9 @@
 #if !defined(_TRACE_HOST1X_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_HOST1X_H
 
+#ifndef CONFIG_TRACEPOINT_HOST1X_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/huge_memory.h b/include/trace/events/huge_memory.h
index 4fdb14a81108..c95601839f41 100644
--- a/include/trace/events/huge_memory.h
+++ b/include/trace/events/huge_memory.h
@@ -5,6 +5,9 @@
 #if !defined(__HUGE_MEMORY_H) || defined(TRACE_HEADER_MULTI_READ)
 #define __HUGE_MEMORY_H
 
+#ifndef CONFIG_TRACEPOINT_HUGE_MEMORY_SWITCH_ON
+#define NOTRACE
+#endif
 #include  <linux/tracepoint.h>
 
 #define SCAN_STATUS							\
diff --git a/include/trace/events/hwmon.h b/include/trace/events/hwmon.h
index d7a1d0ffb679..a3cc24f2be1b 100644
--- a/include/trace/events/hwmon.h
+++ b/include/trace/events/hwmon.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_HWMON_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_HWMON_H
 
+#ifndef CONFIG_TRACEPOINT_HWMON_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 DECLARE_EVENT_CLASS(hwmon_attr_class,
diff --git a/include/trace/events/i2c.h b/include/trace/events/i2c.h
index 142a23c6593c..6ed8d5733150 100644
--- a/include/trace/events/i2c.h
+++ b/include/trace/events/i2c.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_I2C_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_I2C_H
 
+#ifndef CONFIG_TRACEPOINT_I2C_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/i2c.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/ib_mad.h b/include/trace/events/ib_mad.h
index 59363a083ecb..2445f000dce2 100644
--- a/include/trace/events/ib_mad.h
+++ b/include/trace/events/ib_mad.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_IB_MAD_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_IB_MAD_H
 
+#ifndef CONFIG_TRACEPOINT_IB_MAD_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <rdma/ib_mad.h>
 
diff --git a/include/trace/events/ib_umad.h b/include/trace/events/ib_umad.h
index c393a19a0f60..74e504ea5c85 100644
--- a/include/trace/events/ib_umad.h
+++ b/include/trace/events/ib_umad.h
@@ -11,6 +11,9 @@
 #if !defined(_TRACE_IB_UMAD_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_IB_UMAD_H
 
+#ifndef CONFIG_TRACEPOINT_IB_UMAD_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 DECLARE_EVENT_CLASS(ib_umad_template,
diff --git a/include/trace/events/initcall.h b/include/trace/events/initcall.h
index eb903c3f195f..01c2d872da79 100644
--- a/include/trace/events/initcall.h
+++ b/include/trace/events/initcall.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_INITCALL_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_INITCALL_H
 
+#ifndef CONFIG_TRACEPOINT_INITCALL_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(initcall_level,
diff --git a/include/trace/events/intel-sst.h b/include/trace/events/intel-sst.h
index 0416e91f8181..2221c8662bfb 100644
--- a/include/trace/events/intel-sst.h
+++ b/include/trace/events/intel-sst.h
@@ -12,6 +12,9 @@
 #if !defined(_TRACE_INTEL_SST_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_INTEL_SST_H
 
+#ifndef CONFIG_TRACEPOINT_INTEL-SST_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/intel_iommu.h b/include/trace/events/intel_iommu.h
index 112bd06487bf..1fb074704e09 100644
--- a/include/trace/events/intel_iommu.h
+++ b/include/trace/events/intel_iommu.h
@@ -13,6 +13,9 @@
 #if !defined(_TRACE_INTEL_IOMMU_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_INTEL_IOMMU_H
 
+#ifndef CONFIG_TRACEPOINT_INTEL_IOMMU_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/intel-iommu.h>
 
diff --git a/include/trace/events/intel_ish.h b/include/trace/events/intel_ish.h
index e6d7ff55ee8c..7add6bd24dcd 100644
--- a/include/trace/events/intel_ish.h
+++ b/include/trace/events/intel_ish.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_INTEL_ISH_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_INTEL_ISH_H
 
+#ifndef CONFIG_TRACEPOINT_INTEL_ISH_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(ishtp_dump,
diff --git a/include/trace/events/io_uring.h b/include/trace/events/io_uring.h
index 9f0d3b7d56b0..ad180caed987 100644
--- a/include/trace/events/io_uring.h
+++ b/include/trace/events/io_uring.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_IO_URING_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_IO_URING_H
 
+#ifndef CONFIG_TRACEPOINT_IO_URING_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct io_wq_work;
diff --git a/include/trace/events/iocost.h b/include/trace/events/iocost.h
index 0b6869980ba2..6bac2c0509a5 100644
--- a/include/trace/events/iocost.h
+++ b/include/trace/events/iocost.h
@@ -9,6 +9,9 @@ struct ioc_gq;
 #if !defined(_TRACE_BLK_IOCOST_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_BLK_IOCOST_H
 
+#ifndef CONFIG_TRACEPOINT_IOCOST_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(iocost_iocg_activate,
diff --git a/include/trace/events/iommu.h b/include/trace/events/iommu.h
index 72b4582322ff..75935fe825de 100644
--- a/include/trace/events/iommu.h
+++ b/include/trace/events/iommu.h
@@ -11,6 +11,9 @@
 #if !defined(_TRACE_IOMMU_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_IOMMU_H
 
+#ifndef CONFIG_TRACEPOINT_IOMMU_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct device;
diff --git a/include/trace/events/ipi.h b/include/trace/events/ipi.h
index 0be71dad6ec0..30a1e5c3b289 100644
--- a/include/trace/events/ipi.h
+++ b/include/trace/events/ipi.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_IPI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_IPI_H
 
+#ifndef CONFIG_TRACEPOINT_IPI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 /**
diff --git a/include/trace/events/irq.h b/include/trace/events/irq.h
index eeceafaaea4c..73d3fdbab252 100644
--- a/include/trace/events/irq.h
+++ b/include/trace/events/irq.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_IRQ_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_IRQ_H
 
+#ifndef CONFIG_TRACEPOINT_IRQ_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct irqaction;
diff --git a/include/trace/events/irq_matrix.h b/include/trace/events/irq_matrix.h
index 267d4cbbf360..5099166b3843 100644
--- a/include/trace/events/irq_matrix.h
+++ b/include/trace/events/irq_matrix.h
@@ -4,6 +4,9 @@
 #if !defined(_TRACE_IRQ_MATRIX_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_IRQ_MATRIX_H
 
+#ifndef CONFIG_TRACEPOINT_IRQ_MATRIX_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct irq_matrix;
diff --git a/include/trace/events/iscsi.h b/include/trace/events/iscsi.h
index 87408faf6e4e..dcc773f9fdef 100644
--- a/include/trace/events/iscsi.h
+++ b/include/trace/events/iscsi.h
@@ -4,6 +4,9 @@
 #if !defined(_TRACE_ISCSI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_ISCSI_H
 
+#ifndef CONFIG_TRACEPOINT_ISCSI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 /* max debug message length */
diff --git a/include/trace/events/jbd2.h b/include/trace/events/jbd2.h
index d16a32867f3a..98ff076096d1 100644
--- a/include/trace/events/jbd2.h
+++ b/include/trace/events/jbd2.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_JBD2_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_JBD2_H
 
+#ifndef CONFIG_TRACEPOINT_JBD2_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/jbd2.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/kmem.h b/include/trace/events/kmem.h
index f65b1f6db22d..6b9ead28d035 100644
--- a/include/trace/events/kmem.h
+++ b/include/trace/events/kmem.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_KMEM_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_KMEM_H
 
+#ifndef CONFIG_TRACEPOINT_KMEM_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/tracepoint.h>
 #include <trace/events/mmflags.h>
diff --git a/include/trace/events/kvm.h b/include/trace/events/kvm.h
index 26cfb0fa8e7e..c01704568b49 100644
--- a/include/trace/events/kvm.h
+++ b/include/trace/events/kvm.h
@@ -2,6 +2,9 @@
 #if !defined(_TRACE_KVM_MAIN_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_KVM_MAIN_H
 
+#ifndef CONFIG_TRACEPOINT_KVM_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #undef TRACE_SYSTEM
diff --git a/include/trace/events/kyber.h b/include/trace/events/kyber.h
index c0e7d24ca256..4f6850168728 100644
--- a/include/trace/events/kyber.h
+++ b/include/trace/events/kyber.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_KYBER_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_KYBER_H
 
+#ifndef CONFIG_TRACEPOINT_KYBER_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/blkdev.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/libata.h b/include/trace/events/libata.h
index ab69434e2329..7879b3f90ecb 100644
--- a/include/trace/events/libata.h
+++ b/include/trace/events/libata.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_LIBATA_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_LIBATA_H
 
+#ifndef CONFIG_TRACEPOINT_LIBATA_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ata.h>
 #include <linux/libata.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/lock.h b/include/trace/events/lock.h
index d7512129a324..b52d0433f960 100644
--- a/include/trace/events/lock.h
+++ b/include/trace/events/lock.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_LOCK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_LOCK_H
 
+#ifndef CONFIG_TRACEPOINT_LOCK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/lockdep.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/mce.h b/include/trace/events/mce.h
index 1391ada0da3b..a71b58e25589 100644
--- a/include/trace/events/mce.h
+++ b/include/trace/events/mce.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_MCE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_MCE_H
 
+#ifndef CONFIG_TRACEPOINT_MCE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 #include <asm/mce.h>
diff --git a/include/trace/events/mdio.h b/include/trace/events/mdio.h
index 0f241cbe00ab..bb7ff9a41714 100644
--- a/include/trace/events/mdio.h
+++ b/include/trace/events/mdio.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_MDIO_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_MDIO_H
 
+#ifndef CONFIG_TRACEPOINT_MDIO_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT_CONDITION(mdio_access,
diff --git a/include/trace/events/migrate.h b/include/trace/events/migrate.h
index 4d434398d64d..651aa2f37f26 100644
--- a/include/trace/events/migrate.h
+++ b/include/trace/events/migrate.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_MIGRATE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_MIGRATE_H
 
+#ifndef CONFIG_TRACEPOINT_MIGRATE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #define MIGRATE_MODE						\
diff --git a/include/trace/events/mlxsw.h b/include/trace/events/mlxsw.h
index 19a25ed323a5..ec45f4aa1ecd 100644
--- a/include/trace/events/mlxsw.h
+++ b/include/trace/events/mlxsw.h
@@ -7,6 +7,9 @@
 #if !defined(_MLXSW_TRACEPOINT_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _MLXSW_TRACEPOINT_H
 
+#ifndef CONFIG_TRACEPOINT_MLXSW_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct mlxsw_sp;
diff --git a/include/trace/events/mmap.h b/include/trace/events/mmap.h
index 4661f7ba07c0..c1369f984952 100644
--- a/include/trace/events/mmap.h
+++ b/include/trace/events/mmap.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_MMAP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_MMAP_H
 
+#ifndef CONFIG_TRACEPOINT_MMAP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(vm_unmapped_area,
diff --git a/include/trace/events/mmc.h b/include/trace/events/mmc.h
index 7b706ff21335..0c28d7fccd12 100644
--- a/include/trace/events/mmc.h
+++ b/include/trace/events/mmc.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_MMC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_MMC_H
 
+#ifndef CONFIG_TRACEPOINT_MMC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/blkdev.h>
 #include <linux/mmc/core.h>
 #include <linux/mmc/host.h>
diff --git a/include/trace/events/module.h b/include/trace/events/module.h
index 097485c73c01..eed4069366d1 100644
--- a/include/trace/events/module.h
+++ b/include/trace/events/module.h
@@ -15,6 +15,9 @@
 #if !defined(_TRACE_MODULE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_MODULE_H
 
+#ifndef CONFIG_TRACEPOINT_MODULE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #ifdef CONFIG_MODULES
diff --git a/include/trace/events/napi.h b/include/trace/events/napi.h
index 6678cf8b235b..b89f5933dd11 100644
--- a/include/trace/events/napi.h
+++ b/include/trace/events/napi.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_NAPI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NAPI_H
 
+#ifndef CONFIG_TRACEPOINT_NAPI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/netdevice.h>
 #include <linux/tracepoint.h>
 #include <linux/ftrace.h>
diff --git a/include/trace/events/nbd.h b/include/trace/events/nbd.h
index 9849956f34d8..7c1f08318195 100644
--- a/include/trace/events/nbd.h
+++ b/include/trace/events/nbd.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_NBD_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NBD_H
 
+#ifndef CONFIG_TRACEPOINT_NBD_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 DECLARE_EVENT_CLASS(nbd_transport_event,
diff --git a/include/trace/events/neigh.h b/include/trace/events/neigh.h
index 62bb17516713..5264ff70428f 100644
--- a/include/trace/events/neigh.h
+++ b/include/trace/events/neigh.h
@@ -4,6 +4,9 @@
 #if !defined(_TRACE_NEIGH_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NEIGH_H
 
+#ifndef CONFIG_TRACEPOINT_NEIGH_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/skbuff.h>
 #include <linux/netdevice.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/net.h b/include/trace/events/net.h
index 2399073c3afc..e58a442a5c41 100644
--- a/include/trace/events/net.h
+++ b/include/trace/events/net.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_NET_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NET_H
 
+#ifndef CONFIG_TRACEPOINT_NET_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/skbuff.h>
 #include <linux/netdevice.h>
 #include <linux/if_vlan.h>
diff --git a/include/trace/events/nilfs2.h b/include/trace/events/nilfs2.h
index 84ee31fc04cc..2d73ab22fcf0 100644
--- a/include/trace/events/nilfs2.h
+++ b/include/trace/events/nilfs2.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_NILFS2_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NILFS2_H
 
+#ifndef CONFIG_TRACEPOINT_NILFS2_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct nilfs_sc_info;
diff --git a/include/trace/events/nmi.h b/include/trace/events/nmi.h
index 18e0411398ba..f6a3a9982c59 100644
--- a/include/trace/events/nmi.h
+++ b/include/trace/events/nmi.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_NMI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_NMI_H
 
+#ifndef CONFIG_TRACEPOINT_NMI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/objagg.h b/include/trace/events/objagg.h
index fcec0fc9eb0c..76c700dbe62b 100644
--- a/include/trace/events/objagg.h
+++ b/include/trace/events/objagg.h
@@ -7,6 +7,9 @@
 #if !defined(__TRACE_OBJAGG_H) || defined(TRACE_HEADER_MULTI_READ)
 #define __TRACE_OBJAGG_H
 
+#ifndef CONFIG_TRACEPOINT_OBJAGG_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 struct objagg;
diff --git a/include/trace/events/oom.h b/include/trace/events/oom.h
index 26a11e4a2c36..07961b5d243f 100644
--- a/include/trace/events/oom.h
+++ b/include/trace/events/oom.h
@@ -4,6 +4,10 @@
 
 #if !defined(_TRACE_OOM_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_OOM_H
+
+#ifndef CONFIG_TRACEPOINT_OOM_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <trace/events/mmflags.h>
 
diff --git a/include/trace/events/page_isolation.h b/include/trace/events/page_isolation.h
index bf4c42e8d6a4..90dc932c879f 100644
--- a/include/trace/events/page_isolation.h
+++ b/include/trace/events/page_isolation.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_PAGE_ISOLATION_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PAGE_ISOLATION_H
 
+#ifndef CONFIG_TRACEPOINT_PAGE_ISOLATION_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(test_pages_isolated,
diff --git a/include/trace/events/page_pool.h b/include/trace/events/page_pool.h
index ad0aa7f31675..1f4f80c17039 100644
--- a/include/trace/events/page_pool.h
+++ b/include/trace/events/page_pool.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_PAGE_POOL_H) || defined(TRACE_HEADER_MULTI_READ)
 #define      _TRACE_PAGE_POOL_H
 
+#ifndef CONFIG_TRACEPOINT_PAGE_POOL_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/page_ref.h b/include/trace/events/page_ref.h
index 5d2ea93956ce..8bd0bc1cf10d 100644
--- a/include/trace/events/page_ref.h
+++ b/include/trace/events/page_ref.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_PAGE_REF_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PAGE_REF_H
 
+#ifndef CONFIG_TRACEPOINT_PAGE_REF_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/page_ref.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/pagemap.h b/include/trace/events/pagemap.h
index 8fd1babae761..02f281b7197b 100644
--- a/include/trace/events/pagemap.h
+++ b/include/trace/events/pagemap.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_PAGEMAP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PAGEMAP_H
 
+#ifndef CONFIG_TRACEPOINT_PAGEMAP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/mm.h>
 
diff --git a/include/trace/events/percpu.h b/include/trace/events/percpu.h
index df112a64f6c9..a57ef1ca4eb8 100644
--- a/include/trace/events/percpu.h
+++ b/include/trace/events/percpu.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_PERCPU_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PERCPU_H
 
+#ifndef CONFIG_TRACEPOINT_PERCPU_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(percpu_alloc_percpu,
diff --git a/include/trace/events/power.h b/include/trace/events/power.h
index af5018aa9517..f6cc691b2c2a 100644
--- a/include/trace/events/power.h
+++ b/include/trace/events/power.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_POWER_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_POWER_H
 
+#ifndef CONFIG_TRACEPOINT_POWER_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/cpufreq.h>
 #include <linux/ktime.h>
 #include <linux/pm_qos.h>
diff --git a/include/trace/events/power_cpu_migrate.h b/include/trace/events/power_cpu_migrate.h
index e338810639b4..ab787486099b 100644
--- a/include/trace/events/power_cpu_migrate.h
+++ b/include/trace/events/power_cpu_migrate.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_POWER_CPU_MIGRATE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_POWER_CPU_MIGRATE_H
 
+#ifndef CONFIG_TRACEPOINT_POWER_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #define __cpu_migrate_proto			\
diff --git a/include/trace/events/preemptirq.h b/include/trace/events/preemptirq.h
index 3f249e150c0c..69f238fe8c9a 100644
--- a/include/trace/events/preemptirq.h
+++ b/include/trace/events/preemptirq.h
@@ -6,6 +6,9 @@
 #if !defined(_TRACE_PREEMPTIRQ_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PREEMPTIRQ_H
 
+#ifndef CONFIG_TRACEPOINT_PREEMPTIRQ_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 #include <linux/string.h>
diff --git a/include/trace/events/printk.h b/include/trace/events/printk.h
index 13d405b2fd8b..36a80dcf7327 100644
--- a/include/trace/events/printk.h
+++ b/include/trace/events/printk.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_PRINTK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PRINTK_H
 
+#ifndef CONFIG_TRACEPOINT_PRINTK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(console,
diff --git a/include/trace/events/pwc.h b/include/trace/events/pwc.h
index a2da764a3b41..2d6d01b1b531 100644
--- a/include/trace/events/pwc.h
+++ b/include/trace/events/pwc.h
@@ -2,6 +2,9 @@
 #if !defined(_TRACE_PWC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PWC_H
 
+#ifndef CONFIG_TRACEPOINT_PWC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/usb.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/pwm.h b/include/trace/events/pwm.h
index cf243de41cc8..bcf542d56a75 100644
--- a/include/trace/events/pwm.h
+++ b/include/trace/events/pwm.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_PWM_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_PWM_H
 
+#ifndef CONFIG_TRACEPOINT_PWM_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/pwm.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/qdisc.h b/include/trace/events/qdisc.h
index 330d32d84485..2c69246169d2 100644
--- a/include/trace/events/qdisc.h
+++ b/include/trace/events/qdisc.h
@@ -4,6 +4,9 @@
 #if !defined(_TRACE_QDISC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_QDISC_H
 
+#ifndef CONFIG_TRACEPOINT_QDISC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/skbuff.h>
 #include <linux/netdevice.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/qla.h b/include/trace/events/qla.h
index 5857cf682ee7..994ba7b00551 100644
--- a/include/trace/events/qla.h
+++ b/include/trace/events/qla.h
@@ -2,6 +2,9 @@
 #if !defined(_TRACE_QLA_H_) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_QLA_H_
 
+#ifndef CONFIG_TRACEPOINT_QLA_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #undef TRACE_SYSTEM
diff --git a/include/trace/events/qrtr.h b/include/trace/events/qrtr.h
index b1de14c3bb93..26d859280a9c 100644
--- a/include/trace/events/qrtr.h
+++ b/include/trace/events/qrtr.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_QRTR_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_QRTR_H
 
+#ifndef CONFIG_TRACEPOINT_QRTR_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/qrtr.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/random.h b/include/trace/events/random.h
index 9570a10cb949..30a860d2e5bc 100644
--- a/include/trace/events/random.h
+++ b/include/trace/events/random.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_RANDOM_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RANDOM_H
 
+#ifndef CONFIG_TRACEPOINT_RANDOM_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/writeback.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/rcu.h b/include/trace/events/rcu.h
index 155b5cb43cfd..61f7e964ac2e 100644
--- a/include/trace/events/rcu.h
+++ b/include/trace/events/rcu.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_RCU_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RCU_H
 
+#ifndef CONFIG_TRACEPOINT_RCU_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #ifdef CONFIG_RCU_TRACE
diff --git a/include/trace/events/rdma_core.h b/include/trace/events/rdma_core.h
index 17642aa54437..f8c0d98ec3d2 100644
--- a/include/trace/events/rdma_core.h
+++ b/include/trace/events/rdma_core.h
@@ -13,6 +13,9 @@
 #if !defined(_TRACE_RDMA_CORE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RDMA_CORE_H
 
+#ifndef CONFIG_TRACEPOINT_RDMA_CORE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <rdma/ib_verbs.h>
 
diff --git a/include/trace/events/regulator.h b/include/trace/events/regulator.h
index 72b3ba93b0a5..1cc8a53445eb 100644
--- a/include/trace/events/regulator.h
+++ b/include/trace/events/regulator.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_REGULATOR_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_REGULATOR_H
 
+#ifndef CONFIG_TRACEPOINT_REGULATOR_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/rpcgss.h b/include/trace/events/rpcgss.h
index ffdbe6f85da8..90847a56395e 100644
--- a/include/trace/events/rpcgss.h
+++ b/include/trace/events/rpcgss.h
@@ -11,6 +11,9 @@
 #if !defined(_TRACE_RPCRDMA_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RPCGSS_H
 
+#ifndef CONFIG_TRACEPOINT_RPCGSS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 /**
diff --git a/include/trace/events/rpcrdma.h b/include/trace/events/rpcrdma.h
index bf1065772228..c610b21ed8f6 100644
--- a/include/trace/events/rpcrdma.h
+++ b/include/trace/events/rpcrdma.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_RPCRDMA_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RPCRDMA_H
 
+#ifndef CONFIG_TRACEPOINT_RPCRDMA_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/scatterlist.h>
 #include <linux/sunrpc/rpc_rdma_cid.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/rpm.h b/include/trace/events/rpm.h
index 3c716214dab1..a158acd3a5d8 100644
--- a/include/trace/events/rpm.h
+++ b/include/trace/events/rpm.h
@@ -6,6 +6,9 @@
 #if !defined(_TRACE_RUNTIME_POWER_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RUNTIME_POWER_H
 
+#ifndef CONFIG_TRACEPOINT_RPM_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/rseq.h b/include/trace/events/rseq.h
index a04a64bc1a00..7baa95fc25e5 100644
--- a/include/trace/events/rseq.h
+++ b/include/trace/events/rseq.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_RSEQ_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RSEQ_H
 
+#ifndef CONFIG_TRACEPOINT_RSEQ_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/types.h>
 
diff --git a/include/trace/events/rtc.h b/include/trace/events/rtc.h
index 621333f1c890..b3f102f5f496 100644
--- a/include/trace/events/rtc.h
+++ b/include/trace/events/rtc.h
@@ -4,6 +4,9 @@
 #if !defined(_TRACE_RTC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RTC_H
 
+#ifndef CONFIG_TRACEPOINT_RTC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/rtc.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/rxrpc.h b/include/trace/events/rxrpc.h
index e70c90116eda..743ddf85ef7d 100644
--- a/include/trace/events/rxrpc.h
+++ b/include/trace/events/rxrpc.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_RXRPC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_RXRPC_H
 
+#ifndef CONFIG_TRACEPOINT_RXRPC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/errqueue.h>
 
diff --git a/include/trace/events/sched.h b/include/trace/events/sched.h
index e48f584abf5f..731094d9f0ef 100644
--- a/include/trace/events/sched.h
+++ b/include/trace/events/sched.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SCHED_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SCHED_H
 
+#ifndef CONFIG_TRACEPOINT_SCHED_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/sched/numa_balancing.h>
 #include <linux/tracepoint.h>
 #include <linux/binfmts.h>
diff --git a/include/trace/events/scmi.h b/include/trace/events/scmi.h
index f3a4b4d60714..746598ec1826 100644
--- a/include/trace/events/scmi.h
+++ b/include/trace/events/scmi.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SCMI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SCMI_H
 
+#ifndef CONFIG_TRACEPOINT_SCMI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(scmi_xfer_begin,
diff --git a/include/trace/events/scsi.h b/include/trace/events/scsi.h
index f624969a4f14..25dd11d8c0e0 100644
--- a/include/trace/events/scsi.h
+++ b/include/trace/events/scsi.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SCSI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SCSI_H
 
+#ifndef CONFIG_TRACEPOINT_SCSI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <scsi/scsi_cmnd.h>
 #include <scsi/scsi_host.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/sctp.h b/include/trace/events/sctp.h
index d4aac3436595..70933c4bf0b1 100644
--- a/include/trace/events/sctp.h
+++ b/include/trace/events/sctp.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SCTP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SCTP_H
 
+#ifndef CONFIG_TRACEPOINT_SCTP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <net/sctp/structs.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/signal.h b/include/trace/events/signal.h
index 1db7e4b07c01..e9bc5ff84fb7 100644
--- a/include/trace/events/signal.h
+++ b/include/trace/events/signal.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SIGNAL_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SIGNAL_H
 
+#ifndef CONFIG_TRACEPOINT_SIGNAL_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/signal.h>
 #include <linux/sched.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/siox.h b/include/trace/events/siox.h
index 68a43fc2c3a5..6ccdaf55d6d3 100644
--- a/include/trace/events/siox.h
+++ b/include/trace/events/siox.h
@@ -4,6 +4,9 @@
 #if !defined(_TRACE_SIOX_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SIOX_H
 
+#ifndef CONFIG_TRACEPOINT_SIOX_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(siox_set_data,
diff --git a/include/trace/events/skb.h b/include/trace/events/skb.h
index 9e92f22eb086..89b8e0bbd42d 100644
--- a/include/trace/events/skb.h
+++ b/include/trace/events/skb.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SKB_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SKB_H
 
+#ifndef CONFIG_TRACEPOINT_SKB_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/skbuff.h>
 #include <linux/netdevice.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/smbus.h b/include/trace/events/smbus.h
index 71a87edfc46d..58ed5e2de70c 100644
--- a/include/trace/events/smbus.h
+++ b/include/trace/events/smbus.h
@@ -10,6 +10,9 @@
 #if !defined(_TRACE_SMBUS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SMBUS_H
 
+#ifndef CONFIG_TRACEPOINT_SMBUS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/i2c.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/sock.h b/include/trace/events/sock.h
index a966d4b5ab37..56892b6e65c7 100644
--- a/include/trace/events/sock.h
+++ b/include/trace/events/sock.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SOCK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SOCK_H
 
+#ifndef CONFIG_TRACEPOINT_SOCK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <net/sock.h>
 #include <net/ipv6.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/spi.h b/include/trace/events/spi.h
index 0dd9171d2ad8..5ba19e820ddd 100644
--- a/include/trace/events/spi.h
+++ b/include/trace/events/spi.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SPI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SPI_H
 
+#ifndef CONFIG_TRACEPOINT_SPI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ktime.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/spmi.h b/include/trace/events/spmi.h
index 8b60efe18ba6..5158d263fdab 100644
--- a/include/trace/events/spmi.h
+++ b/include/trace/events/spmi.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SPMI_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SPMI_H
 
+#ifndef CONFIG_TRACEPOINT_SPMI_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/spmi.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/sunrpc.h b/include/trace/events/sunrpc.h
index 23db248a7fdb..9f5ef43b0809 100644
--- a/include/trace/events/sunrpc.h
+++ b/include/trace/events/sunrpc.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SUNRPC_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SUNRPC_H
 
+#ifndef CONFIG_TRACEPOINT_SUNRPC_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/sunrpc/sched.h>
 #include <linux/sunrpc/clnt.h>
 #include <linux/sunrpc/svc.h>
diff --git a/include/trace/events/sunvnet.h b/include/trace/events/sunvnet.h
index 8d444f1bb10d..1f125e6c8226 100644
--- a/include/trace/events/sunvnet.h
+++ b/include/trace/events/sunvnet.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SUNVNET_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SUNVNET_H
 
+#ifndef CONFIG_TRACEPOINT_SUNVNET_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(vnet_rx_one,
diff --git a/include/trace/events/swiotlb.h b/include/trace/events/swiotlb.h
index 705be43b71ab..8de6ea3a7cb9 100644
--- a/include/trace/events/swiotlb.h
+++ b/include/trace/events/swiotlb.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_SWIOTLB_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_SWIOTLB_H
 
+#ifndef CONFIG_TRACEPOINT_SWIOTLB_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(swiotlb_bounced,
diff --git a/include/trace/events/syscalls.h b/include/trace/events/syscalls.h
index b6e0cbc2c71f..4717186cb9e5 100644
--- a/include/trace/events/syscalls.h
+++ b/include/trace/events/syscalls.h
@@ -7,6 +7,9 @@
 #if !defined(_TRACE_EVENTS_SYSCALLS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_EVENTS_SYSCALLS_H
 
+#ifndef CONFIG_TRACEPOINT_SYSCALLS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #include <asm/ptrace.h>
diff --git a/include/trace/events/target.h b/include/trace/events/target.h
index 67fad2677ed5..fb551199fe39 100644
--- a/include/trace/events/target.h
+++ b/include/trace/events/target.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_TARGET_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_TARGET_H
 
+#ifndef CONFIG_TRACEPOINT_TARGET_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/trace_seq.h>
 #include <scsi/scsi_proto.h>
diff --git a/include/trace/events/task.h b/include/trace/events/task.h
index 64d160930b0d..fc4ad21a0bb8 100644
--- a/include/trace/events/task.h
+++ b/include/trace/events/task.h
@@ -4,6 +4,10 @@
 
 #if !defined(_TRACE_TASK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_TASK_H
+
+#ifndef CONFIG_TRACEPOINT_TASK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(task_newtask,
diff --git a/include/trace/events/tcp.h b/include/trace/events/tcp.h
index cf97f6339acb..48bb873a922f 100644
--- a/include/trace/events/tcp.h
+++ b/include/trace/events/tcp.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_TCP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_TCP_H
 
+#ifndef CONFIG_TRACEPOINT_TCP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/ipv6.h>
 #include <linux/tcp.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/tegra_apb_dma.h b/include/trace/events/tegra_apb_dma.h
index 971cd02d2daf..3d9946e8e93f 100644
--- a/include/trace/events/tegra_apb_dma.h
+++ b/include/trace/events/tegra_apb_dma.h
@@ -1,6 +1,9 @@
 #if !defined(_TRACE_TEGRA_APB_DMA_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_TEGRA_APB_DMA_H
 
+#ifndef CONFIG_TRACEPOINT_TEGRA_APB_DMA_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/dmaengine.h>
 
diff --git a/include/trace/events/thermal.h b/include/trace/events/thermal.h
index 135e5421f003..26396ba01606 100644
--- a/include/trace/events/thermal.h
+++ b/include/trace/events/thermal.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_THERMAL_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_THERMAL_H
 
+#ifndef CONFIG_TRACEPOINT_THERMAL_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/devfreq.h>
 #include <linux/thermal.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/thermal_power_allocator.h b/include/trace/events/thermal_power_allocator.h
index 1c8fb95544f9..f3a35b3fcf0b 100644
--- a/include/trace/events/thermal_power_allocator.h
+++ b/include/trace/events/thermal_power_allocator.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_THERMAL_POWER_ALLOCATOR_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_THERMAL_POWER_ALLOCATOR_H
 
+#ifndef CONFIG_TRACEPOINT_THERMAL_POWER_ALLOCATOR_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(thermal_power_allocator,
diff --git a/include/trace/events/thp.h b/include/trace/events/thp.h
index d7fbbe551841..5dc81adea31b 100644
--- a/include/trace/events/thp.h
+++ b/include/trace/events/thp.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_THP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_THP_H
 
+#ifndef CONFIG_TRACEPOINT_THP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/timer.h b/include/trace/events/timer.h
index 19abb6c3eb73..2aaf64a3faa0 100644
--- a/include/trace/events/timer.h
+++ b/include/trace/events/timer.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_TIMER_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_TIMER_H
 
+#ifndef CONFIG_TRACEPOINT_TIMER_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/hrtimer.h>
 #include <linux/timer.h>
diff --git a/include/trace/events/tlb.h b/include/trace/events/tlb.h
index b4d8e7dc38f8..b60d96c55283 100644
--- a/include/trace/events/tlb.h
+++ b/include/trace/events/tlb.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_TLB_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_TLB_H
 
+#ifndef CONFIG_TRACEPOINT_TLB_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/mm_types.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/udp.h b/include/trace/events/udp.h
index 336fe272889f..f4076e360295 100644
--- a/include/trace/events/udp.h
+++ b/include/trace/events/udp.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_UDP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_UDP_H
 
+#ifndef CONFIG_TRACEPOINT_UDP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/udp.h>
 #include <linux/tracepoint.h>
 
diff --git a/include/trace/events/ufs.h b/include/trace/events/ufs.h
index 84841b3a7ffd..6f4db89740f7 100644
--- a/include/trace/events/ufs.h
+++ b/include/trace/events/ufs.h
@@ -9,6 +9,9 @@
 #if !defined(_TRACE_UFS_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_UFS_H
 
+#ifndef CONFIG_TRACEPOINT_UFS_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 #define UFS_LINK_STATES			\
diff --git a/include/trace/events/v4l2.h b/include/trace/events/v4l2.h
index 248bc09bfc99..4df1a4ebbf12 100644
--- a/include/trace/events/v4l2.h
+++ b/include/trace/events/v4l2.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_V4L2_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_V4L2_H
 
+#ifndef CONFIG_TRACEPOINT_V4L2_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <media/videobuf2-v4l2.h>
 
diff --git a/include/trace/events/vb2.h b/include/trace/events/vb2.h
index a40146dea83d..9aa84d6b98a0 100644
--- a/include/trace/events/vb2.h
+++ b/include/trace/events/vb2.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_VB2_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_VB2_H
 
+#ifndef CONFIG_TRACEPOINT_VB2_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <media/videobuf2-core.h>
 
diff --git a/include/trace/events/vmscan.h b/include/trace/events/vmscan.h
index 2070df64958e..4e009a58010d 100644
--- a/include/trace/events/vmscan.h
+++ b/include/trace/events/vmscan.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_VMSCAN_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_VMSCAN_H
 
+#ifndef CONFIG_TRACEPOINT_VMSCAN_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/types.h>
 #include <linux/tracepoint.h>
 #include <linux/mm.h>
diff --git a/include/trace/events/vsock_virtio_transport_common.h b/include/trace/events/vsock_virtio_transport_common.h
index 6782213778be..492df1d76081 100644
--- a/include/trace/events/vsock_virtio_transport_common.h
+++ b/include/trace/events/vsock_virtio_transport_common.h
@@ -6,6 +6,9 @@
     defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_VSOCK_VIRTIO_TRANSPORT_COMMON_H
 
+#ifndef CONFIG_TRACEPOINT_VSOCK_VIRTIO_TRANSPORT_COMMON_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 
 TRACE_DEFINE_ENUM(VIRTIO_VSOCK_TYPE_STREAM);
diff --git a/include/trace/events/wbt.h b/include/trace/events/wbt.h
index 9c66e59d859c..2a9ed18eb4a0 100644
--- a/include/trace/events/wbt.h
+++ b/include/trace/events/wbt.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_WBT_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_WBT_H
 
+#ifndef CONFIG_TRACEPOINT_WBT_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include "../../../block/blk-wbt.h"
 
diff --git a/include/trace/events/workqueue.h b/include/trace/events/workqueue.h
index 9b8ae961acc5..5734d9c1f06a 100644
--- a/include/trace/events/workqueue.h
+++ b/include/trace/events/workqueue.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_WORKQUEUE_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_WORKQUEUE_H
 
+#ifndef CONFIG_TRACEPOINT_WORKQUEUE_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/workqueue.h>
 
diff --git a/include/trace/events/writeback.h b/include/trace/events/writeback.h
index 57d795365987..0162526ee557 100644
--- a/include/trace/events/writeback.h
+++ b/include/trace/events/writeback.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_WRITEBACK_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_WRITEBACK_H
 
+#ifndef CONFIG_TRACEPOINT_WRITEBACK_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <linux/backing-dev.h>
 #include <linux/writeback.h>
diff --git a/include/trace/events/xdp.h b/include/trace/events/xdp.h
index cd24e8a59529..1ded5be7efac 100644
--- a/include/trace/events/xdp.h
+++ b/include/trace/events/xdp.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_XDP_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_XDP_H
 
+#ifndef CONFIG_TRACEPOINT_XDP_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/netdevice.h>
 #include <linux/filter.h>
 #include <linux/tracepoint.h>
diff --git a/include/trace/events/xen.h b/include/trace/events/xen.h
index 3b61b587e137..6cb9ad58dfd3 100644
--- a/include/trace/events/xen.h
+++ b/include/trace/events/xen.h
@@ -5,6 +5,9 @@
 #if !defined(_TRACE_XEN_H) || defined(TRACE_HEADER_MULTI_READ)
 #define _TRACE_XEN_H
 
+#ifndef CONFIG_TRACEPOINT_XEN_SWITCH_ON
+#define NOTRACE
+#endif
 #include <linux/tracepoint.h>
 #include <asm/paravirt_types.h>
 #include <asm/xen/trace_types.h>
diff --git a/init/main.c b/init/main.c
index dd26a42e80a8..b030c5a0ddc3 100644
--- a/init/main.c
+++ b/init/main.c
@@ -18,6 +18,8 @@
 #include <linux/proc_fs.h>
 #include <linux/binfmts.h>
 #include <linux/kernel.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/initcall.h>
 #include <linux/syscalls.h>
 #include <linux/stackprotector.h>
 #include <linux/string.h>
@@ -105,9 +107,6 @@
 #include <asm/sections.h>
 #include <asm/cacheflush.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/initcall.h>
-
 #include <kunit/test.h>
 
 static int kernel_init(void *);
diff --git a/kernel/exit.c b/kernel/exit.c
index f5933bd07932..2e7db7b5444f 100644
--- a/kernel/exit.c
+++ b/kernel/exit.c
@@ -39,6 +39,7 @@
 #include <linux/taskstats_kern.h>
 #include <linux/delayacct.h>
 #include <linux/cgroup.h>
+#include <trace/events/sched.h>
 #include <linux/syscalls.h>
 #include <linux/signal.h>
 #include <linux/posix-timers.h>
@@ -54,7 +55,6 @@
 #include <linux/fs_struct.h>
 #include <linux/init_task.h>
 #include <linux/perf_event.h>
-#include <trace/events/sched.h>
 #include <linux/hw_breakpoint.h>
 #include <linux/oom.h>
 #include <linux/writeback.h>
diff --git a/kernel/fork.c b/kernel/fork.c
index 27f042d75850..0e0448e52462 100644
--- a/kernel/fork.c
+++ b/kernel/fork.c
@@ -52,6 +52,7 @@
 #include <linux/hugetlb.h>
 #include <linux/seccomp.h>
 #include <linux/swap.h>
+#include <trace/events/sched.h>
 #include <linux/syscalls.h>
 #include <linux/jiffies.h>
 #include <linux/futex.h>
@@ -104,8 +105,6 @@
 #include <asm/cacheflush.h>
 #include <asm/tlbflush.h>
 
-#include <trace/events/sched.h>
-
 #define CREATE_TRACE_POINTS
 #include <trace/events/task.h>
 
diff --git a/kernel/kmod.c b/kernel/kmod.c
index 3cd075ce2a1e..8d574d616157 100644
--- a/kernel/kmod.c
+++ b/kernel/kmod.c
@@ -5,6 +5,7 @@
 #include <linux/sched.h>
 #include <linux/sched/task.h>
 #include <linux/binfmts.h>
+#include <trace/events/module.h>
 #include <linux/syscalls.h>
 #include <linux/unistd.h>
 #include <linux/kmod.h>
@@ -26,8 +27,6 @@
 #include <linux/async.h>
 #include <linux/uaccess.h>
 
-#include <trace/events/module.h>
-
 /*
  * Assuming:
  *
diff --git a/kernel/module.c b/kernel/module.c
index af1d1ecfb110..40adcbfff4d6 100644
--- a/kernel/module.c
+++ b/kernel/module.c
@@ -7,6 +7,8 @@
 
 #define INCLUDE_VERMAGIC
 
+#define CREATE_TRACE_POINTS
+#include <trace/events/module.h>
 #include <linux/export.h>
 #include <linux/extable.h>
 #include <linux/moduleloader.h>
@@ -60,9 +62,6 @@
 #include <uapi/linux/module.h>
 #include "module-internal.h"
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/module.h>
-
 #ifndef ARCH_SHF_SMALL
 #define ARCH_SHF_SMALL 0
 #endif
diff --git a/kernel/power/process.c b/kernel/power/process.c
index 45b054b7b5ec..9ca0cc218b0e 100644
--- a/kernel/power/process.c
+++ b/kernel/power/process.c
@@ -15,12 +15,12 @@
 #include <linux/module.h>
 #include <linux/sched/debug.h>
 #include <linux/sched/task.h>
+#include <trace/events/power.h>
 #include <linux/syscalls.h>
 #include <linux/freezer.h>
 #include <linux/delay.h>
 #include <linux/workqueue.h>
 #include <linux/kmod.h>
-#include <trace/events/power.h>
 #include <linux/cpuset.h>
 
 /*
diff --git a/kernel/printk/printk.c b/kernel/printk/printk.c
index 0e5f41eed1eb..a560d1a05928 100644
--- a/kernel/printk/printk.c
+++ b/kernel/printk/printk.c
@@ -33,6 +33,8 @@
 #include <linux/smp.h>
 #include <linux/security.h>
 #include <linux/memblock.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/printk.h>
 #include <linux/syscalls.h>
 #include <linux/crash_core.h>
 #include <linux/ratelimit.h>
@@ -54,9 +56,8 @@
 #include <linux/uaccess.h>
 #include <asm/sections.h>
 
+#undef CREATE_TRACE_POINTS
 #include <trace/events/initcall.h>
-#define CREATE_TRACE_POINTS
-#include <trace/events/printk.h>
 
 #include "printk_ringbuffer.h"
 #include "console_cmdline.h"
diff --git a/kernel/rseq.c b/kernel/rseq.c
index a4f86a9d6937..a4e36200dc30 100644
--- a/kernel/rseq.c
+++ b/kernel/rseq.c
@@ -10,14 +10,13 @@
 
 #include <linux/sched.h>
 #include <linux/uaccess.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/rseq.h>
 #include <linux/syscalls.h>
 #include <linux/rseq.h>
 #include <linux/types.h>
 #include <asm/ptrace.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/rseq.h>
-
 #define RSEQ_CS_PREEMPT_MIGRATE_FLAGS (RSEQ_CS_FLAG_NO_RESTART_ON_MIGRATE | \
 				       RSEQ_CS_FLAG_NO_RESTART_ON_PREEMPT)
 
diff --git a/kernel/sched/idle.c b/kernel/sched/idle.c
index 36b545f17206..a928a46b3be6 100644
--- a/kernel/sched/idle.c
+++ b/kernel/sched/idle.c
@@ -6,9 +6,8 @@
  * (NOTE: these are not related to SCHED_IDLE batch scheduled
  *        tasks which are handled in sched/fair.c )
  */
-#include "sched.h"
-
 #include <trace/events/power.h>
+#include "sched.h"
 
 /* Linker adds these: start and end of __cpuidle functions */
 extern char __cpuidle_text_start[], __cpuidle_text_end[];
diff --git a/kernel/sched/sched.h b/kernel/sched/sched.h
index 190d170d8d6b..96830256cb1b 100644
--- a/kernel/sched/sched.h
+++ b/kernel/sched/sched.h
@@ -62,6 +62,7 @@
 #include <linux/stop_machine.h>
 #include <linux/suspend.h>
 #include <linux/swait.h>
+#include <trace/events/sched.h>
 #include <linux/syscalls.h>
 #include <linux/task_work.h>
 #include <linux/tsacct_kern.h>
@@ -76,8 +77,6 @@
 #include "cpupri.h"
 #include "cpudeadline.h"
 
-#include <trace/events/sched.h>
-
 #ifdef CONFIG_SCHED_DEBUG
 # define SCHED_WARN_ON(x)	WARN_ONCE(x, #x)
 #else
diff --git a/kernel/signal.c b/kernel/signal.c
index 0be3c40c5662..2f9793e3b732 100644
--- a/kernel/signal.c
+++ b/kernel/signal.c
@@ -28,6 +28,8 @@
 #include <linux/binfmts.h>
 #include <linux/coredump.h>
 #include <linux/security.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/signal.h>
 #include <linux/syscalls.h>
 #include <linux/ptrace.h>
 #include <linux/signal.h>
@@ -48,9 +50,6 @@
 #include <linux/cgroup.h>
 #include <linux/audit.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/signal.h>
-
 #include <asm/param.h>
 #include <linux/uaccess.h>
 #include <asm/unistd.h>
diff --git a/kernel/time/hrtimer.c b/kernel/time/hrtimer.c
index 1256f2ce948b..27ad17d70d0b 100644
--- a/kernel/time/hrtimer.c
+++ b/kernel/time/hrtimer.c
@@ -27,6 +27,7 @@
 #include <linux/percpu.h>
 #include <linux/hrtimer.h>
 #include <linux/notifier.h>
+#include <trace/events/timer.h>
 #include <linux/syscalls.h>
 #include <linux/interrupt.h>
 #include <linux/tick.h>
@@ -44,8 +45,6 @@
 
 #include <linux/uaccess.h>
 
-#include <trace/events/timer.h>
-
 #include "tick-internal.h"
 
 /*
diff --git a/kernel/time/itimer.c b/kernel/time/itimer.c
index 00629e658ca1..889038351125 100644
--- a/kernel/time/itimer.c
+++ b/kernel/time/itimer.c
@@ -7,13 +7,13 @@
 
 #include <linux/mm.h>
 #include <linux/interrupt.h>
+#include <trace/events/timer.h>
 #include <linux/syscalls.h>
 #include <linux/time.h>
 #include <linux/sched/signal.h>
 #include <linux/sched/cputime.h>
 #include <linux/posix-timers.h>
 #include <linux/hrtimer.h>
-#include <trace/events/timer.h>
 #include <linux/compat.h>
 
 #include <linux/uaccess.h>
diff --git a/kernel/time/timer.c b/kernel/time/timer.c
index af3daf03c917..a823d8a57a0a 100644
--- a/kernel/time/timer.c
+++ b/kernel/time/timer.c
@@ -32,9 +32,11 @@
 #include <linux/jiffies.h>
 #include <linux/posix-timers.h>
 #include <linux/cpu.h>
+#include <linux/tick.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/timer.h>
 #include <linux/syscalls.h>
 #include <linux/delay.h>
-#include <linux/tick.h>
 #include <linux/kallsyms.h>
 #include <linux/irq_work.h>
 #include <linux/sched/signal.h>
@@ -53,9 +55,6 @@
 
 #include "tick-internal.h"
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/timer.h>
-
 __visible u64 jiffies_64 __cacheline_aligned_in_smp = INITIAL_JIFFIES;
 
 EXPORT_SYMBOL(jiffies_64);
diff --git a/kernel/trace/Kconfig b/kernel/trace/Kconfig
index 29db703f6880..4077531badb5 100644
--- a/kernel/trace/Kconfig
+++ b/kernel/trace/Kconfig
@@ -131,6 +131,8 @@ menuconfig FTRACE
 
 if FTRACE
 
+source "kernel/trace/Kconfig.tracepoint"
+
 config BOOTTIME_TRACING
 	bool "Boot-time Tracing support"
 	depends on TRACING
@@ -305,6 +307,7 @@ config SCHED_TRACER
 	select CONTEXT_SWITCH_TRACER
 	select TRACER_MAX_TRACE
 	select TRACER_SNAPSHOT
+	select TRACEPOINT_SCHED_SWITCH_ON
 	help
 	  This tracer tracks the latency of the highest priority task
 	  to be scheduled in, starting from the point it has woken up.
diff --git a/kernel/trace/Kconfig.tracepoint b/kernel/trace/Kconfig.tracepoint
new file mode 100644
index 000000000000..607f68383fb2
--- /dev/null
+++ b/kernel/trace/Kconfig.tracepoint
@@ -0,0 +1,877 @@
+menu "Tracepoint Event Swtich"
+
+menu "Core tracepoint"
+
+config TRACEPOINT_SCHED_SWITCH_ON
+	bool "SCHED tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS || SCHED_TRACER || SCHEDSTATS
+	help
+	  Switch on subsys sched tracepoint
+
+config TRACEPOINT_PREEMPTIRQ_SWITCH_ON
+	bool "PREEMPTIRQ tracepoint switch on"
+	depends on TRACE_PREEMPT_TOGGLE || TRACE_IRQFLAGS
+	default y if ENABLE_DEFAULT_TRACERS || PREEMPTIRQ_TRACEPOINTS
+	help
+	  Switch on subsys preemptirq tracepoint
+
+config TRACEPOINT_IPI_SWITCH_ON
+	bool "IPI tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys ipi tracepoint
+
+config TRACEPOINT_IRQ_SWITCH_ON
+	bool "IRQ tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys irq tracepoint
+
+config TRACEPOINT_MIGRATE_SWITCH_ON
+	bool "MIGRATE tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys migrate tracepoint
+
+config TRACEPOINT_RCU_SWITCH_ON
+	bool "RCU tracepoint switch on"
+	depends on RCU_TRACE
+	default y if RCU_TRACE || ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys rcu tracepoint
+
+config TRACEPOINT_RSEQ_SWITCH_ON
+	bool "RSEQ tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys rseq tracepoint
+
+config TRACEPOINT_SIGNAL_SWITCH_ON
+	bool "SIGNAL tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys signal tracepoint
+
+config TRACEPOINT_SYSCALLS_SWITCH_ON
+	bool "SYSCALLS tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+#	select TRACEPOINT_BLOCK_SWITCH_ON
+#	select TRACEPOINT_POWER_SWITCH_ON
+	help
+	  Switch on subsys syscalls tracepoint
+
+config TRACEPOINT_TASK_SWITCH_ON
+	bool "TASK tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	select TRACEPOINT_SCHED_SWITCH_ON
+	help
+	  Switch on subsys task tracepoint
+
+config TRACEPOINT_TIMER_SWITCH_ON
+	bool "TIMER tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys timer tracepoint
+
+config TRACEPOINT_WORKQUEUE_SWITCH_ON
+	bool "WORKQUEUE tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys workqueue tracepoint
+
+config TRACEPOINT_POWER_SWITCH_ON
+	bool "POWER tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys power tracepoint
+
+config TRACEPOINT_MODULE_SWITCH_ON
+	bool "MODULE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys module tracepoint
+
+config TRACEPOINT_INITCALL_SWITCH_ON
+	bool "INITCALL tracepoint switch on"
+	default n
+	help
+	  Switch on subsys initcall tracepoint
+
+config TRACEPOINT_CONTEXT_TRACKING_SWITCH_ON
+	bool "CONTEXT_TRACKING tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys context_tracking tracepoint
+
+config TRACEPOINT_CPUHP_SWITCH_ON
+	bool "CPUHP tracepoint switch on"
+	select TRACEPOINT_POWER_SWITCH_ON
+	default n
+	help
+	  Switch on subsys cpuhp tracepoint
+
+config TRACEPOINT_CGROUP_SWITCH_ON
+	bool "CGROUP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys cgroup tracepoint
+
+config TRACEPOINT_IRQ_MATRIX_SWITCH_ON
+	bool "IRQ_MATRIX tracepoint switch on"
+	default n
+	help
+	  Switch on subsys irq_matrix tracepoint
+
+config TRACEPOINT_LOCK_SWITCH_ON
+	bool "LOCK tracepoint switch on"
+	default n
+	help
+	  Switch on subsys lock tracepoint
+
+config TRACEPOINT_NMI_SWITCH_ON
+	bool "NMI tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys nmi tracepoint
+
+config TRACEPOINT_PRINTK_SWITCH_ON
+	bool "PRINTK tracepoint switch on"
+	default n
+	help
+	  Switch on subsys printk tracepoint
+
+endmenu
+
+menu "Memory tracepoint"
+config TRACEPOINT_CACHEFILES_SWITCH_ON
+	bool "CACHEFILES tracepoint switch on"
+	default n
+	help
+	  Switch on subsys cachefiles tracepoint
+
+config TRACEPOINT_CMA_SWITCH_ON
+	bool "CMA tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys cma tracepoint
+
+config TRACEPOINT_COMPACTION_SWITCH_ON
+	bool "COMPACTION tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys compaction tracepoint
+
+config TRACEPOINT_HUGE_MEMORY_SWITCH_ON
+	bool "HUGE_MEMORY tracepoint switch on"
+	default n
+	help
+	  Switch on subsys huge_memory tracepoint
+
+config TRACEPOINT_KMEM_SWITCH_ON
+	bool "KMEM tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys kmem tracepoint
+
+config TRACEPOINT_MMAP_SWITCH_ON
+	bool "MMAP tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys mmap tracepoint
+
+config TRACEPOINT_OOM_SWITCH_ON
+	bool "OOM tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys oom tracepoint
+
+config TRACEPOINT_PAGE_ISOLATION_SWITCH_ON
+	bool "PAGE_ISOLATION tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys page_isolation tracepoint
+
+config TRACEPOINT_PAGEMAP_SWITCH_ON
+	bool "PAGEMAP tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys pagemap tracepoint
+
+config TRACEPOINT_PAGE_POOL_SWITCH_ON
+	bool "PAGE_POOL tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys page_pool tracepoint
+
+config TRACEPOINT_PAGE_REF_SWITCH_ON
+	bool "PAGE_REF tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys page_ref tracepoint
+
+config TRACEPOINT_PERCPU_SWITCH_ON
+	bool "PERCPU tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys percpu tracepoint
+
+config TRACEPOINT_THP_SWITCH_ON
+	bool "THP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys thp tracepoint
+
+config TRACEPOINT_TLB_SWITCH_ON
+	bool "TLB tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	help
+	  Switch on subsys tlb tracepoint
+
+config TRACEPOINT_VMSCAN_SWITCH_ON
+	bool "VMSCAN tracepoint switch on"
+	default y if ENABLE_DEFAULT_TRACERS
+	select TRACEPOINT_WRITEBACK_SWITCH_ON
+	help
+	  Switch on subsys vmscan tracepoint
+
+config TRACEPOINT_SWIOTLB_SWITCH_ON
+	bool "SWIOTLB tracepoint switch on"
+	default n
+	help
+	  Switch on subsys swiotlb tracepoint
+
+endmenu
+
+menu "Block tracepoint"
+
+config TRACEPOINT_BLOCK_SWITCH_ON
+	bool "BLOCK tracepoint switch on"
+#	depends on TRACEPOINT_SYSCALLS_SWITCH_ON
+	default n
+	help
+	  Switch on subsys block tracepoint
+
+config TRACEPOINT_BCACHE_SWITCH_ON
+	bool "BCACHE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys bcache tracepoint
+
+config TRACEPOINT_IOCOST_SWITCH_ON
+	bool "IOCOST tracepoint switch on"
+	default n
+	help
+	  Switch on subsys iocost tracepoint
+
+config TRACEPOINT_KYBER_SWITCH_ON
+	bool "KYBER tracepoint switch on"
+	default n
+	help
+	  Switch on subsys kyber tracepoint
+
+config TRACEPOINT_WBT_SWITCH_ON
+	bool "WBT tracepoint switch on"
+	default n
+	help
+	  Switch on subsys wbt tracepoint
+
+endmenu
+
+menu "Network tracepoint"
+
+config TRACEPOINT_BRIDGE_SWITCH_ON
+	bool "BRIDGE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys bridge tracepoint
+
+config TRACEPOINT_FIB6_SWITCH_ON
+	bool "FIB6 tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fib6 tracepoint
+
+config TRACEPOINT_FIB_SWITCH_ON
+	bool "FIB tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fib tracepoint
+
+config TRACEPOINT_NAPI_SWITCH_ON
+	bool "NAPI tracepoint switch on"
+	default n
+	help
+	  Switch on subsys napi tracepoint
+
+config TRACEPOINT_NBD_SWITCH_ON
+	bool "NBD tracepoint switch on"
+	default n
+	help
+	  Switch on subsys nbd tracepoint
+
+config TRACEPOINT_NEIGH_SWITCH_ON
+	bool "NEIGH tracepoint switch on"
+	default n
+	help
+	  Switch on subsys neigh tracepoint
+
+config TRACEPOINT_NET_SWITCH_ON
+	bool "NET tracepoint switch on"
+	default n
+	help
+	  Switch on subsys net tracepoint
+
+config TRACEPOINT_NET_PROBE_COMMON_SWITCH_ON
+	bool "NET_PROBE_COMMON tracepoint switch on"
+	default n
+	help
+	  Switch on subsys net_probe_common tracepoint
+
+config TRACEPOINT_QDISC_SWITCH_ON
+	bool "QDISC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys qdisc tracepoint
+
+config TRACEPOINT_QRTR_SWITCH_ON
+	bool "QRTR tracepoint switch on"
+	default n
+	help
+	  Switch on subsys qrtr tracepoint
+
+config TRACEPOINT_RPCGSS_SWITCH_ON
+	bool "RPCGSS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys rpcgss tracepoint
+
+config TRACEPOINT_RPCRDMA_SWITCH_ON
+	bool "RPCRDMA tracepoint switch on"
+	default n
+	help
+	  Switch on subsys rpcrdma tracepoint
+
+config TRACEPOINT_RXRPC_SWITCH_ON
+	bool "RXRPC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys rxrpc tracepoint
+
+config TRACEPOINT_SCTP_SWITCH_ON
+	bool "SCTP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys sctp tracepoint
+
+config TRACEPOINT_SKB_SWITCH_ON
+	bool "SKB tracepoint switch on"
+	default n
+	help
+	  Switch on subsys skb tracepoint
+
+config TRACEPOINT_SOCK_SWITCH_ON
+	bool "SOCK tracepoint switch on"
+	default n
+	help
+	  Switch on subsys sock tracepoint
+
+config TRACEPOINT_SUNRPC_SWITCH_ON
+	bool "SUNRPC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys sunrpc tracepoint
+
+config TRACEPOINT_SUNVNET_SWITCH_ON
+	bool "SUNVNET tracepoint switch on"
+	default n
+	help
+	  Switch on subsys sunvnet tracepoint
+
+config TRACEPOINT_TCP_SWITCH_ON
+	bool "TCP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys tcp tracepoint
+
+config TRACEPOINT_UDP_SWITCH_ON
+	bool "UDP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys udp tracepoint
+
+config TRACEPOINT_VSOCK_VIRTIO_TRANSPORT_COMMON_SWITCH_ON
+	bool "VSOCK_VIRTIO_TRANSPORT_COMMON tracepoint switch on"
+	default n
+	help
+	  Switch on subsys vsock_virtio_transport_common tracepoint
+
+config TRACEPOINT_XDP_SWITCH_ON
+	bool "XDP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys xdp tracepoint
+
+endmenu
+
+menu "Filesystem tracepoint"
+
+config TRACEPOINT_WRITEBACK_SWITCH_ON
+	bool "WRITEBACK tracepoint switch on"
+	default n
+	help
+	  Switch on subsys writeback tracepoint
+
+config TRACEPOINT_IOMAP_SWITCH_ON
+	bool "IOMAP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys iomap tracepoint
+
+config TRACEPOINT_NFS_SWITCH_ON
+	bool "NFS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys nfs tracepoint
+
+config TRACEPOINT_NFS4_SWITCH_ON
+	bool "NFS V4 tracepoint switch on"
+	default n
+	help
+	  Switch on subsys nfs v4 tracepoint
+
+config TRACEPOINT_9P_SWITCH_ON
+	bool "9P tracepoint switch on"
+	default n
+	help
+	  Switch on subsys 9p tracepoint
+
+config TRACEPOINT_AFS_SWITCH_ON
+	bool "AFS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys afs tracepoint
+
+config TRACEPOINT_BTRFS_SWITCH_ON
+	bool "BTRFS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys btrfs tracepoint
+
+config TRACEPOINT_EROFS_SWITCH_ON
+	bool "EROFS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys erofs tracepoint
+
+config TRACEPOINT_EXT4_SWITCH_ON
+	bool "EXT4 tracepoint switch on"
+	default n
+	help
+	  Switch on subsys ext4 tracepoint
+
+config TRACEPOINT_F2FS_SWITCH_ON
+	bool "F2FS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys f2fs tracepoint
+
+config TRACEPOINT_FILELOCK_SWITCH_ON
+	bool "FILELOCK tracepoint switch on"
+	default n
+	help
+	  Switch on subsys filelock tracepoint
+
+config TRACEPOINT_FILEMAP_SWITCH_ON
+	bool "FILEMAP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys filemap tracepoint
+
+config TRACEPOINT_FSCACHE_SWITCH_ON
+	bool "FSCACHE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fscache tracepoint
+
+config TRACEPOINT_FS_DAX_SWITCH_ON
+	bool "FS_DAX tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fs_dax tracepoint
+
+config TRACEPOINT_IO_URING_SWITCH_ON
+	bool "IO_URING tracepoint switch on"
+	default n
+	help
+	  Switch on subsys io_uring tracepoint
+
+config TRACEPOINT_JBD2_SWITCH_ON
+	bool "JBD2 tracepoint switch on"
+	default n
+	help
+	  Switch on subsys jbd2 tracepoint
+
+config TRACEPOINT_NILFS2_SWITCH_ON
+	bool "NILFS2 tracepoint switch on"
+	default n
+	help
+	  Switch on subsys nilfs2 tracepoint
+
+endmenu
+
+menu "Driver tracepoint"
+
+config TRACEPOINT_REGMAP_SWITCH_ON
+	bool "REGMAP tracepoint switch on"
+	default n
+	help
+	  Switch on subsys regmap tracepoint
+
+config TRACEPOINT_ALARMTIMER_SWITCH_ON
+	bool "ALARMTIMER tracepoint switch on"
+	default n
+	help
+	  Switch on subsys alarmtimer tracepoint
+
+config TRACEPOINT_ASOC_SWITCH_ON
+	bool "ASOC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys asoc tracepoint
+
+config TRACEPOINT_AVC_SWITCH_ON
+	bool "AVC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys avc tracepoint
+
+config TRACEPOINT_CLK_SWITCH_ON
+	bool "CLK tracepoint switch on"
+	default n
+	help
+	  Switch on subsys clk tracepoint
+
+config TRACEPOINT_DEVFREQ_SWITCH_ON
+	bool "DEVFREQ tracepoint switch on"
+	default n
+	help
+	  Switch on subsys devfreq tracepoint
+
+config TRACEPOINT_DEVLINK_SWITCH_ON
+	bool "DEVLINK tracepoint switch on"
+	default n
+	help
+	  Switch on subsys devlink tracepoint
+
+config TRACEPOINT_DMA_FENCE_SWITCH_ON
+	bool "DMA_FENCE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys dma_fence tracepoint
+
+config TRACEPOINT_GPIO_SWITCH_ON
+	bool "GPIO tracepoint switch on"
+	default n
+	help
+	  Switch on subsys gpio tracepoint
+
+config TRACEPOINT_GPU_MEM_SWITCH_ON
+	bool "GPU_MEM tracepoint switch on"
+	default n
+	help
+	  Switch on subsys gpu_mem tracepoint
+
+config TRACEPOINT_FSI_SWITCH_ON
+	bool "FSI tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fsi tracepoint
+
+config TRACEPOINT_FSI_MASTER_ASPEED_SWITCH_ON
+	bool "FSI_MASTER_ASPEED tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fsi_master_aspeed tracepoint
+
+config TRACEPOINT_FSI_MASTER_AST_CF_SWITCH_ON
+	bool "FSI_MASTER_AST_CF tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fsi_master_ast_cf tracepoint
+
+config TRACEPOINT_FSI_MASTER_GPIO_SWITCH_ON
+	bool "FSI_MASTER_GPIO tracepoint switch on"
+	default n
+	help
+	  Switch on subsys fsi_master_gpio tracepoint
+
+config TRACEPOINT_HOST1X_SWITCH_ON
+	bool "HOST1X tracepoint switch on"
+	default n
+	help
+	  Switch on subsys host1x tracepoint
+
+config TRACEPOINT_HWMON_SWITCH_ON
+	bool "HWMON tracepoint switch on"
+	default n
+	help
+	  Switch on subsys hwmon tracepoint
+
+config TRACEPOINT_I2C_SWITCH_ON
+	bool "I2C tracepoint switch on"
+	default n
+	help
+	  Switch on subsys i2c tracepoint
+
+config TRACEPOINT_SMBUS_SWITCH_ON
+	bool "SMBUS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys smbus tracepoint
+
+config TRACEPOINT_IB_MAD_SWITCH_ON
+	bool "IB_MAD tracepoint switch on"
+	default n
+	help
+	  Switch on subsys ib_mad tracepoint
+
+config TRACEPOINT_IB_UMAD_SWITCH_ON
+	bool "IB_UMAD tracepoint switch on"
+	default n
+	help
+	  Switch on subsys ib_umad tracepoint
+
+config TRACEPOINT_INTEL_IOMMU_SWITCH_ON
+	bool "INTEL_IOMMU tracepoint switch on"
+	default n
+	help
+	  Switch on subsys intel_iommu tracepoint
+
+config TRACEPOINT_INTEL_ISH_SWITCH_ON
+	bool "INTEL_ISH tracepoint switch on"
+	default n
+	help
+	  Switch on subsys intel_ish tracepoint
+
+config TRACEPOINT_INTEL-SST_SWITCH_ON
+	bool "INTEL-SST tracepoint switch on"
+	default n
+	help
+	  Switch on subsys intel-sst tracepoint
+
+config TRACEPOINT_MMC_SWITCH_ON
+	bool "MMC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys mmc tracepoint
+
+config TRACEPOINT_PWC_SWITCH_ON
+	bool "PWC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys pwc tracepoint
+
+config TRACEPOINT_PWM_SWITCH_ON
+	bool "PWM tracepoint switch on"
+	default n
+	help
+	  Switch on subsys pwm tracepoint
+
+config TRACEPOINT_RDMA_CORE_SWITCH_ON
+	bool "RDMA_CORE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys rdma_core tracepoint
+
+config TRACEPOINT_RDMA_SWITCH_ON
+	bool "RDMA tracepoint switch on"
+	default n
+	help
+	  Switch on subsys rdma tracepoint
+
+config TRACEPOINT_REGULATOR_SWITCH_ON
+	bool "REGULATOR tracepoint switch on"
+	default n
+	help
+	  Switch on subsys regulator tracepoint
+
+config TRACEPOINT_THERMAL_SWITCH_ON
+	bool "THERMAL tracepoint switch on"
+	default n
+	help
+	  Switch on subsys thermal tracepoint
+
+config TRACEPOINT_THERMAL_POWER_ALLOCATOR_SWITCH_ON
+	bool "THERMAL_POWER_ALLOCATOR tracepoint switch on"
+	default n
+	help
+	  Switch on subsys thermal_power_allocator tracepoint
+
+config TRACEPOINT_NVME_SWITCH_ON
+	bool "NVME tracepoint switch on"
+	default n
+	help
+	  Switch on subsys NVME tracepoint
+
+config TRACEPOINT_SPI_SWITCH_ON
+	bool "SPI tracepoint switch on"
+	default n
+	help
+	  Switch on subsys spi tracepoint
+
+config TRACEPOINT_SPMI_SWITCH_ON
+	bool "SPMI tracepoint switch on"
+	default n
+	help
+	  Switch on subsys spmi tracepoint
+
+config TRACEPOINT_IOMMU_SWITCH_ON
+	bool "IOMMU tracepoint switch on"
+	default n
+	help
+	  Switch on subsys iommu tracepoint
+
+config TRACEPOINT_ISCSI_SWITCH_ON
+	bool "ISCSI tracepoint switch on"
+	default n
+	help
+	  Switch on subsys iscsi tracepoint
+
+config TRACEPOINT_LIBATA_SWITCH_ON
+	bool "LIBATA tracepoint switch on"
+	default n
+	help
+	  Switch on subsys libata tracepoint
+
+config TRACEPOINT_MDIO_SWITCH_ON
+	bool "MDIO tracepoint switch on"
+	default n
+	help
+	  Switch on subsys mdio tracepoint
+
+config TRACEPOINT_MLXSW_SWITCH_ON
+	bool "MLXSW tracepoint switch on"
+	default n
+	help
+	  Switch on subsys mlxsw tracepoint
+
+config TRACEPOINT_QLA_SWITCH_ON
+	bool "QLA tracepoint switch on"
+	default n
+	help
+	  Switch on subsys qla tracepoint
+
+config TRACEPOINT_RANDOM_SWITCH_ON
+	bool "RANDOM tracepoint switch on"
+	default n
+	help
+	  Switch on subsys random tracepoint
+
+config TRACEPOINT_RPM_SWITCH_ON
+	bool "RPM tracepoint switch on"
+	default n
+	help
+	  Switch on subsys rpm tracepoint
+
+config TRACEPOINT_RTC_SWITCH_ON
+	bool "RTC tracepoint switch on"
+	default n
+	help
+	  Switch on subsys rtc tracepoint
+
+config TRACEPOINT_SCMI_SWITCH_ON
+	bool "SCMI tracepoint switch on"
+	default n
+	help
+	  Switch on subsys scmi tracepoint
+
+config TRACEPOINT_SCSI_SWITCH_ON
+	bool "SCSI tracepoint switch on"
+	default n
+	help
+	  Switch on subsys scsi tracepoint
+
+config TRACEPOINT_UFS_SWITCH_ON
+	bool "UFS tracepoint switch on"
+	default n
+	help
+	  Switch on subsys ufs tracepoint
+
+config TRACEPOINT_SIOX_SWITCH_ON
+	bool "SIOX tracepoint switch on"
+	default n
+	help
+	  Switch on subsys siox tracepoint
+
+config TRACEPOINT_TARGET_SWITCH_ON
+	bool "TARGET tracepoint switch on"
+	default n
+	help
+	  Switch on subsys target tracepoint
+
+config TRACEPOINT_TEGRA_APB_DMA_SWITCH_ON
+	bool "TEGRA_APB_DMA tracepoint switch on"
+	default n
+	help
+	  Switch on subsys tegra_apb_dma tracepoint
+
+config TRACEPOINT_V4L2_SWITCH_ON
+	bool "V4L2 tracepoint switch on"
+	default n
+	help
+	  Switch on subsys v4l2 tracepoint
+
+config TRACEPOINT_VB2_SWITCH_ON
+	bool "VB2 tracepoint switch on"
+	default n
+	help
+	  Switch on subsys vb2 tracepoint
+
+endmenu
+
+menu "Misc tracepoint"
+
+config TRACEPOINT_RAS_EVENT_SWITCH_ON
+	bool "RAS_EVENT tracepoint switch on"
+	default n
+	help
+	  Switch on subsys ras_event tracepoint
+
+config TRACEPOINT_BPF_TEST_RUN_SWITCH_ON
+	bool "BPF_TEST_RUN tracepoint switch on"
+	default n
+	help
+	  Switch on subsys bpf_test_run tracepoint
+
+config TRACEPOINT_BPF_TRACE_SWITCH_ON
+	bool "BPF_TRACE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys bpf_trace tracepoint
+
+config TRACEPOINT_KVM_SWITCH_ON
+	bool "KVM tracepoint switch on"
+	default n
+	help
+	  Switch on subsys kvm tracepoint
+
+config TRACEPOINT_MCE_SWITCH_ON
+	bool "MCE tracepoint switch on"
+	default n
+	help
+	  Switch on subsys mce tracepoint
+
+config TRACEPOINT_OBJAGG_SWITCH_ON
+	bool "OBJAGG tracepoint switch on"
+	default n
+	help
+	  Switch on subsys objagg tracepoint
+
+config TRACEPOINT_XEN_SWITCH_ON
+	bool "XEN tracepoint switch on"
+	default n
+	help
+	  Switch on subsys xen tracepoint
+
+endmenu
+endmenu
diff --git a/kernel/trace/bpf_trace.c b/kernel/trace/bpf_trace.c
index ba644760f507..7a539d150ad2 100644
--- a/kernel/trace/bpf_trace.c
+++ b/kernel/trace/bpf_trace.c
@@ -13,6 +13,8 @@
 #include <linux/ctype.h>
 #include <linux/kprobes.h>
 #include <linux/spinlock.h>
+#define CREATE_TRACE_POINTS
+#include "bpf_trace.h"
 #include <linux/syscalls.h>
 #include <linux/error-injection.h>
 #include <linux/btf_ids.h>
@@ -25,9 +27,6 @@
 #include "trace_probe.h"
 #include "trace.h"
 
-#define CREATE_TRACE_POINTS
-#include "bpf_trace.h"
-
 #define bpf_event_rcu_dereference(p)					\
 	rcu_dereference_protected(p, lockdep_is_held(&bpf_event_mutex))
 
diff --git a/kernel/trace/bpf_trace.h b/kernel/trace/bpf_trace.h
index 9acbc11ac7bb..d21f633de046 100644
--- a/kernel/trace/bpf_trace.h
+++ b/kernel/trace/bpf_trace.h
@@ -6,6 +6,10 @@
 
 #define _TRACE_BPF_TRACE_H
 
+#ifndef CONFIG_TRACEPOINT_BPF_TRACE_SWITCH_ON
+#define NOTRACE
+#endif
+
 #include <linux/tracepoint.h>
 
 TRACE_EVENT(bpf_trace_printk,
diff --git a/kernel/trace/trace_irqsoff.c b/kernel/trace/trace_irqsoff.c
index f11add83c108..588344f19100 100644
--- a/kernel/trace/trace_irqsoff.c
+++ b/kernel/trace/trace_irqsoff.c
@@ -15,11 +15,10 @@
 #include <linux/module.h>
 #include <linux/ftrace.h>
 #include <linux/kprobes.h>
+#include <trace/events/preemptirq.h>
 
 #include "trace.h"
 
-#include <trace/events/preemptirq.h>
-
 #if defined(CONFIG_IRQSOFF_TRACER) || defined(CONFIG_PREEMPT_TRACER)
 static struct trace_array		*irqsoff_trace __read_mostly;
 static int				tracer_enabled __read_mostly;
diff --git a/kernel/trace/trace_preemptirq.c b/kernel/trace/trace_preemptirq.c
index f4938040c228..8a807871bd6c 100644
--- a/kernel/trace/trace_preemptirq.c
+++ b/kernel/trace/trace_preemptirq.c
@@ -10,11 +10,12 @@
 #include <linux/module.h>
 #include <linux/ftrace.h>
 #include <linux/kprobes.h>
-#include "trace.h"
 
 #define CREATE_TRACE_POINTS
 #include <trace/events/preemptirq.h>
 
+#include "trace.h"
+
 #ifdef CONFIG_TRACE_IRQFLAGS
 /* Per-cpu variable to prevent redundant calls when IRQs already off */
 static DEFINE_PER_CPU(int, tracing_irq_cpu);
diff --git a/mm/migrate.c b/mm/migrate.c
index 278e6f3fa62c..8428923aca7f 100644
--- a/mm/migrate.c
+++ b/mm/migrate.c
@@ -33,6 +33,8 @@
 #include <linux/security.h>
 #include <linux/backing-dev.h>
 #include <linux/compaction.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/migrate.h>
 #include <linux/syscalls.h>
 #include <linux/compat.h>
 #include <linux/hugetlb.h>
@@ -52,9 +54,6 @@
 
 #include <asm/tlbflush.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/migrate.h>
-
 #include "internal.h"
 
 /*
diff --git a/mm/mmap.c b/mm/mmap.c
index 5c8b4485860d..b320cae98a16 100644
--- a/mm/mmap.c
+++ b/mm/mmap.c
@@ -18,6 +18,8 @@
 #include <linux/mman.h>
 #include <linux/pagemap.h>
 #include <linux/swap.h>
+#define CREATE_TRACE_POINTS
+#include <trace/events/mmap.h>
 #include <linux/syscalls.h>
 #include <linux/capability.h>
 #include <linux/init.h>
@@ -53,9 +55,6 @@
 #include <asm/tlb.h>
 #include <asm/mmu_context.h>
 
-#define CREATE_TRACE_POINTS
-#include <trace/events/mmap.h>
-
 #include "internal.h"
 
 #ifndef arch_mmap_check
diff --git a/mm/page-writeback.c b/mm/page-writeback.c
index eb34d204d4ee..ba91e05db11f 100644
--- a/mm/page-writeback.c
+++ b/mm/page-writeback.c
@@ -31,6 +31,7 @@
 #include <linux/smp.h>
 #include <linux/sysctl.h>
 #include <linux/cpu.h>
+#include <trace/events/writeback.h>
 #include <linux/syscalls.h>
 #include <linux/buffer_head.h> /* __set_page_dirty_buffers */
 #include <linux/pagevec.h>
@@ -38,7 +39,6 @@
 #include <linux/sched/rt.h>
 #include <linux/sched/signal.h>
 #include <linux/mm_inline.h>
-#include <trace/events/writeback.h>
 
 #include "internal.h"
 
-- 
2.17.1

